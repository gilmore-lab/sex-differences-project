<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Yiming Qian &amp; Rick Gilmore" />


<title>Analyses for Qian, Berenbaum, &amp; Gilmore</title>

<script src="qian-berenbaum-gilmore_files/header-attrs-2.9/header-attrs.js"></script>
<script src="qian-berenbaum-gilmore_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="qian-berenbaum-gilmore_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="qian-berenbaum-gilmore_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="qian-berenbaum-gilmore_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="qian-berenbaum-gilmore_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="qian-berenbaum-gilmore_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="qian-berenbaum-gilmore_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="qian-berenbaum-gilmore_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="qian-berenbaum-gilmore_files/navigation-1.1/tabsets.js"></script>
<script src="qian-berenbaum-gilmore_files/navigation-1.1/codefolding.js"></script>
<link href="qian-berenbaum-gilmore_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="qian-berenbaum-gilmore_files/highlightjs-9.12.0/highlight.js"></script>
<script src="qian-berenbaum-gilmore_files/kePrint-0.0.1/kePrint.js"></script>
<link href="qian-berenbaum-gilmore_files/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Analyses for Qian, Berenbaum, &amp; Gilmore</h1>
<h4 class="author">Yiming Qian &amp; Rick Gilmore</h4>
<h4 class="date">2021-10-11 15:22:21</h4>

</div>


<div id="purpose" class="section level1">
<h1>Purpose</h1>
<p>This document shows our analyses following a plan we preregistered here:</p>
<p><a href="https://aspredicted.org/5iv9a.pdf" class="uri">https://aspredicted.org/5iv9a.pdf</a></p>
<p>It also shows a series of analyses that were not preregistered.</p>
</div>
<div id="setup" class="section level1">
<h1>Setup</h1>
<p>Set chunk options and load libraries.</p>
</div>
<div id="import-data" class="section level1">
<h1>Import data</h1>
<p>Data from the set of tasks were merged and cleaned as described in <code>import-clean-raw-data.Rmd</code>.</p>
<pre class="r"><code>sex_diff_df &lt;- readr::read_csv(file.path(params$data_path, params$csv_fn)) </code></pre>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   .default = col_double(),
##   Sex = col_character(),
##   Race = col_character(),
##   Age = col_character(),
##   School_year = col_character(),
##   Major = col_character(),
##   Handedness = col_character(),
##   Glasses = col_character(),
##   Acuity = col_character(),
##   Color_vision = col_logical()
## )
## ℹ Use `spec()` for the full column specifications.</code></pre>
</div>
<div id="preregistered-analyses" class="section level1">
<h1>Preregistered analyses</h1>
<div id="individual-measures" class="section level2">
<h2>Individual measures</h2>
<div id="visual-perception-thresholds" class="section level3">
<h3>Visual perception thresholds</h3>
<blockquote>
<p>An average threshold for each participant will be calculated across 4 runs for each visual perception task. If necessary, we will transform the psychophysical thresholds to make the distributions symmetric and appropriate for parametric analyses.</p>
</blockquote>
<p>In the analyses below, we use the median threshold across the four runs.</p>
<p>The distribution of median thresholds is skewed, as indicated in the figures below:</p>
<pre class="r"><code>sex_diff_df %&gt;%
  ggplot(.) +
  aes(x = contrast_thr) +
  geom_histogram()</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 2 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="img/contrast-hist-1.png" width="2100" style="display: block; margin: auto;" /></p>
<pre class="r"><code>sex_diff_df %&gt;%
  ggplot(.) +
  aes(x = motion_dur_thr) +
  geom_histogram()</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="img/motion-hist-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>So, we use a log transformation.</p>
<pre class="r"><code>sex_diff_df &lt;- sex_diff_df %&gt;%
  dplyr::mutate(.,
                log_contrast = log(contrast_thr),
                log_motion = log(motion_dur_thr))</code></pre>
<blockquote>
<p>To examine sex differences, one-tailed t tests will be conducted to compare men and women on 2 visual perception thresholds, spatial ability, and masculine hobbies. We will use verbal ability as our control variable. We set a family-wise Type I error rate at alpha=0.05. Because there are four dependent variables hypothesized to show sex differences, the critical p value for each sex comparison is 0.0125 after Bonferroni correction. Our goal is to obtain .8 power to detect a medium effect size of .5 (Cohen’s d) at the p value of .0125 in the one-tailed t tests. Unequal sample sizes of the two sexes may be collected in this study.</p>
</blockquote>
<div id="contrast-thresholds" class="section level4">
<h4>Contrast thresholds</h4>
<pre class="r"><code>df_contrast &lt;- sex_diff_df %&gt;%
  dplyr::filter(., !is.na(log_contrast)) %&gt;%
  dplyr::select(., Sex, log_contrast)
xtabs(~ Sex, df_contrast)</code></pre>
<pre><code>## Sex
## Female   Male 
##    100     30</code></pre>
<pre class="r"><code>sex_diff_df %&gt;%
  ggplot() +
  aes(Sex, log_contrast) +
  geom_boxplot()</code></pre>
<pre><code>## Warning: Removed 2 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="img/unnamed-chunk-3-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>We then test for a difference in means.</p>
<pre class="r"><code>cst_tt &lt;-
  t.test(
    log_contrast ~ Sex,
    data = sex_diff_df,
    var.equal = TRUE,
    alternative = &quot;greater&quot;
  ) # Hypothesized
cst_tt</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  log_contrast by Sex
## t = 2.4867, df = 128, p-value = 0.00709
## alternative hypothesis: true difference in means between group Female and group Male is greater than 0
## 95 percent confidence interval:
##  0.02900351        Inf
## sample estimates:
## mean in group Female   mean in group Male 
##            -1.741348            -1.828258</code></pre>
<p>Median log(contrast) thresholds are lower in women than men This means that women had larger contrast thresholds or were less sensitive to contrast.</p>
<p>This can be seen in a plot in the original threshold units.</p>
<pre class="r"><code>sex_diff_df %&gt;%
  ggplot() +
  aes(Sex, contrast_thr) +
  geom_boxplot()</code></pre>
<pre><code>## Warning: Removed 2 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="img/unnamed-chunk-5-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>We use the <code>esvis</code> package to compute the Hedge’s G effect size measure since the groups have unequal means.</p>
<pre class="r"><code>esvis::hedg_g(sex_diff_df, log_contrast ~ Sex)</code></pre>
<pre><code>## # A tibble: 2 × 4
##   Sex_ref Sex_foc  coh_d hedg_g
##   &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;
## 1 Female  Male     0.518  0.515
## 2 Male    Female  -0.518 -0.515</code></pre>
<p>In order to compute a confidence interval for the effect size, we use the <code>esci</code> package. We have already installed the package, so we set the following chunk to <code>eval=FALSE</code>.</p>
<pre class="r"><code>devtools::install_github(&quot;rcalinjageman/esci&quot;)</code></pre>
<pre class="r"><code>sex_diff_df$Sex.factor &lt;- as.factor(sex_diff_df$Sex)

es_log_contrast &lt;- esci::estimateMeanDifference.default(sex_diff_df,
                                     Sex.factor,
                                     log_contrast,
                                     paired = FALSE,
                                     var.equal = TRUE,
                                     conf.level = .95)
#es_log_contrast</code></pre>
<p>d_unbiased = 0.51 95% CI [0.11, 0.94]</p>
</div>
<div id="motion-duration-thresholds" class="section level4">
<h4>Motion duration thresholds</h4>
<pre class="r"><code>df_motion &lt;- sex_diff_df %&gt;%
  dplyr::filter(., !is.na(log_motion)) %&gt;%
  dplyr::select(., Sex, log_motion)
xtabs(~ Sex, df_motion)</code></pre>
<pre><code>## Sex
## Female   Male 
##     98     30</code></pre>
<pre class="r"><code>sex_diff_df %&gt;%
  ggplot() +
  aes(Sex, log_motion) +
  geom_boxplot()</code></pre>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="img/unnamed-chunk-9-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>We then test for a difference in means.</p>
<pre class="r"><code>mdt_tt &lt;-
  t.test(
    log_motion ~ Sex,
    data = sex_diff_df,
    var.equal = TRUE,
    alternative = &quot;greater&quot;
  ) # Hypothesized
mdt_tt</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  log_motion by Sex
## t = 3.509, df = 126, p-value = 0.0003122
## alternative hypothesis: true difference in means between group Female and group Male is greater than 0
## 95 percent confidence interval:
##  0.09735106        Inf
## sample estimates:
## mean in group Female   mean in group Male 
##            -2.270497            -2.454955</code></pre>
<p>Median log(motion duration) thresholds are larger in women than men This means that women were less sensitive to motion.</p>
<p>This can be seen in a plot in the original threshold units.</p>
<pre class="r"><code>sex_diff_df %&gt;%
  ggplot() +
  aes(Sex, motion_dur_thr) +
  geom_boxplot()</code></pre>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="img/unnamed-chunk-11-1.png" width="2100" style="display: block; margin: auto;" /></p>
<pre class="r"><code>esvis::hedg_g(sex_diff_df, log_motion ~ Sex)</code></pre>
<pre><code>## # A tibble: 2 × 4
##   Sex_ref Sex_foc  coh_d hedg_g
##   &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;
## 1 Female  Male     0.732  0.728
## 2 Male    Female  -0.732 -0.728</code></pre>
<p>Using <code>esci</code> to calculate a CI:</p>
<pre class="r"><code>es_log_motion &lt;- esci::estimateMeanDifference.default(sex_diff_df,
                                     Sex.factor,
                                     log_motion,
                                     paired = FALSE,
                                     var.equal = TRUE,
                                     conf.level = .95)
#es_log_motion</code></pre>
<p>d_unbiased = 0.73 95% CI [0.32, 1.16]</p>
</div>
</div>
<div id="spatial-ability" class="section level3">
<h3>Spatial ability</h3>
<p>Our measure of spatial ability is performance on a mental rotation task.</p>
<pre class="r"><code>df_mental_rot &lt;- sex_diff_df %&gt;%
  dplyr::filter(., !is.na(mental_rot)) %&gt;%
  dplyr::select(., Sex, mental_rot)
xtabs(~ Sex, df_mental_rot)</code></pre>
<pre><code>## Sex
## Female   Male 
##    101     30</code></pre>
<pre class="r"><code>sex_diff_df %&gt;%
  ggplot() +
  aes(Sex, mental_rot) +
  geom_boxplot()</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="img/unnamed-chunk-14-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>We test for a difference in means.</p>
<pre class="r"><code>mr_tt &lt;-
  t.test(
    mental_rot ~ Sex,
    data = sex_diff_df,
    var.equal = TRUE,
    alternative = &quot;less&quot;
  ) # Hypothesized
mr_tt</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  mental_rot by Sex
## t = -2.7478, df = 129, p-value = 0.003429
## alternative hypothesis: true difference in means between group Female and group Male is less than 0
## 95 percent confidence interval:
##       -Inf -1.373374
## sample estimates:
## mean in group Female   mean in group Male 
##             26.20792             29.66667</code></pre>
<p>Women had fewer correct trials than men. This is shown by the effect size.</p>
<pre class="r"><code>esvis::hedg_g(sex_diff_df, mental_rot ~ Sex)</code></pre>
<pre><code>## # A tibble: 2 × 4
##   Sex_ref Sex_foc  coh_d hedg_g
##   &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;
## 1 Female  Male    -0.571 -0.568
## 2 Male    Female   0.571  0.568</code></pre>
<p>Using <code>esci</code> to calculate CIs.</p>
<pre class="r"><code>es_mental_rot &lt;- esci::estimateMeanDifference.default(sex_diff_df,
                                     Sex.factor,
                                     mental_rot,
                                     paired = FALSE,
                                     var.equal = TRUE,
                                     conf.level = .95)
#es_mental_rot</code></pre>
<p>d_unbiased = -0.57 95% CI [-1.00, -0.16].</p>
</div>
<div id="male-typed-hobbies" class="section level3">
<h3>Male-typed hobbies</h3>
<pre class="r"><code>df_m_hobbies &lt;- sex_diff_df %&gt;%
  dplyr::filter(., !is.na(Masculine_hobbies)) %&gt;%
  dplyr::select(., Sex, Masculine_hobbies)
xtabs(~ Sex, df_m_hobbies)</code></pre>
<pre><code>## Sex
## Female   Male 
##    101     30</code></pre>
<pre class="r"><code>sex_diff_df %&gt;%
  ggplot() +
  aes(Sex, Masculine_hobbies) +
  geom_boxplot()</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="img/unnamed-chunk-18-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>We test for a difference in means.</p>
<pre class="r"><code>mr_tt &lt;-
  t.test(
    Masculine_hobbies ~ Sex,
    data = sex_diff_df,
    var.equal = TRUE,
    alternative = &quot;less&quot;
  )   # Hypothesized
mr_tt</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  Masculine_hobbies by Sex
## t = -7.5758, df = 129, p-value = 3.046e-12
## alternative hypothesis: true difference in means between group Female and group Male is less than 0
## 95 percent confidence interval:
##        -Inf -0.6126882
## sample estimates:
## mean in group Female   mean in group Male 
##             2.840264             3.624444</code></pre>
<pre class="r"><code>esvis::hedg_g(sex_diff_df, Masculine_hobbies ~ Sex)</code></pre>
<pre><code>## # A tibble: 2 × 4
##   Sex_ref Sex_foc coh_d hedg_g
##   &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;
## 1 Female  Male    -1.58  -1.57
## 2 Male    Female   1.58   1.57</code></pre>
<p>Using <code>esci</code> to calculate CIs.</p>
<pre class="r"><code>es_m_hobbies &lt;- esci::estimateMeanDifference.default(sex_diff_df,
                                     Sex.factor,
                                     Masculine_hobbies,
                                     paired = FALSE,
                                     var.equal = TRUE,
                                     conf.level = .95)
#es_m_hobbies</code></pre>
<p>d_unbiased = -1.57 95% CI [-2.05, -1.14].</p>
</div>
<div id="verbal-ability" class="section level3">
<h3>Verbal ability</h3>
<p>We predicted no sex difference in verbal ability as measured by vocabulary size.</p>
<pre class="r"><code>sex_diff_df %&gt;%
  ggplot() +
  aes(Sex, Masculine_hobbies) +
  geom_boxplot()</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="img/unnamed-chunk-21-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>We test for a difference in means.</p>
<pre class="r"><code>vocab_tt &lt;-
  t.test(
    vocab ~ Sex,
    data = sex_diff_df,
    var.equal = TRUE,
    alternative = &quot;two.sided&quot;
  ) # Hypothesized
vocab_tt</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  vocab by Sex
## t = -0.74845, df = 129, p-value = 0.4556
## alternative hypothesis: true difference in means between group Female and group Male is not equal to 0
## 95 percent confidence interval:
##  -2.735626  1.233976
## sample estimates:
## mean in group Female   mean in group Male 
##             9.165842             9.916667</code></pre>
<p>We find no statistically significant difference in vocabulary scores.</p>
<p>This is also shown by the effect size.</p>
<pre class="r"><code>esvis::hedg_g(sex_diff_df, vocab ~ Sex)</code></pre>
<pre><code>## # A tibble: 2 × 4
##   Sex_ref Sex_foc  coh_d hedg_g
##   &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;
## 1 Female  Male    -0.156 -0.155
## 2 Male    Female   0.156  0.155</code></pre>
<pre class="r"><code>es_vocab &lt;- esci::estimateMeanDifference.default(sex_diff_df,
                                     Sex.factor,
                                     vocab,
                                     paired = FALSE,
                                     var.equal = TRUE,
                                     conf.level = .95)
#es_vocab</code></pre>
<p>d_unbiased = -1.57 95% CI [-2.05, -1.14].</p>
<div id="get-group-means-and-sds" class="section level4">
<h4>Get group means and SDs</h4>
<p>Mental rotation</p>
<pre class="r"><code>df_mental_rot %&gt;% 
  group_by(Sex) %&gt;% 
  summarise(mean=mean(mental_rot,na.rm=T),sd=sd(mental_rot,na.rm=T))%&gt;% 
  mutate_if(is.numeric, format, 2)</code></pre>
<pre><code>## # A tibble: 2 × 3
##   Sex    mean     sd      
##   &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;   
## 1 Female 26.20792 6.003860
## 2 Male   29.66667 6.221949</code></pre>
<p>Vocabulary</p>
<pre class="r"><code>sex_diff_df %&gt;% 
  group_by(Sex) %&gt;% 
  summarise(mean=mean(vocab,na.rm=T),sd=sd(vocab,na.rm=T))%&gt;% 
  mutate_if(is.numeric, format, 2)</code></pre>
<pre><code>## # A tibble: 2 × 3
##   Sex    mean     sd      
##   &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;   
## 1 Female 9.165842 4.636173
## 2 Male   9.916667 5.424376</code></pre>
<p>Interest in male-typed hobbies</p>
<pre class="r"><code>sex_diff_df %&gt;% 
  group_by(Sex) %&gt;% 
  summarise(mean=mean(Masculine_hobbies,na.rm=T),sd=sd(Masculine_hobbies,na.rm=T))%&gt;% 
  mutate_if(is.numeric, format, 2)</code></pre>
<pre><code>## # A tibble: 2 × 3
##   Sex    mean     sd       
##   &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;    
## 1 Female 2.840264 0.5008508
## 2 Male   3.624444 0.4872264</code></pre>
</div>
</div>
</div>
<div id="correlations-among-measures" class="section level2">
<h2>Correlations among measures</h2>
<blockquote>
<p>To examine how individual differences of visual perception measures are associated with other tasks, we will use correlations within sex. The lower visual perception threshold is, the higher perceptual sensitivity this individual has. In both sexes, we expect to find negative correlations between visual perception measures and spatial ability and masculine hobbies, but no significant correlation with verbal ability. There are four planned correlations (two visual perception tasks times two cognitive tasks) within sex, for a total of eight. This project is a novel study that has not to our knowledge been conducted previously. So we have consciously decided to maintain strict control of Type II error, in order to have enough statistical power to detect a small correlation effect sizes (r=0.20) within the constraints of sample size. This decision to maximize the power (.80) leads to a trade-off between Type I and Type II error. We plan to conduct eight separate one-tailed correlation tests with Type I error at 0.05 and no Bonferroni correction. With a critical p value of .05, around 150 participants are required for each group to detect an effect size of 0.20 at an obtained power of 0.8 with a one-tailed correlation test.</p>
</blockquote>
<p>We create two data frames, one for males and another for females.</p>
<pre class="r"><code>sex_diff_df_F &lt;- sex_diff_df %&gt;%
  dplyr::filter(., Sex == &quot;Female&quot;) %&gt;%
  dplyr::select( 
                log_contrast,
                log_motion,
                mental_rot,
                vocab,
                Masculine_hobbies,
                masscale
               )</code></pre>
<pre class="r"><code>sex_diff_df_M &lt;- sex_diff_df %&gt;%
  dplyr::filter(., Sex == &quot;Male&quot;) %&gt;%
  dplyr::select( 
                log_contrast,
                log_motion,
                mental_rot,
                vocab,
               Masculine_hobbies,
                masscale
               )</code></pre>
<div id="contrast-thresholds-and-mental-rotation" class="section level3">
<h3>Contrast thresholds and mental rotation</h3>
<div id="women" class="section level4">
<h4>Women</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_F$log_contrast,
  sex_diff_df_F$mental_rot,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_F$log_contrast and sex_diff_df_F$mental_rot
## t = -2.9154, df = 97, p-value = 0.002206
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.0000000 -0.1233413
## sample estimates:
##        cor 
## -0.2838364</code></pre>
<p>Contrast thresholds (negatively) correlate with mental rotation scores in women. The negative correlation means that smaller log(contrast) values or higher contrast sensitivity is associated with better performance in the mental rotation task.</p>
<p>We can use <code>esci</code> to provide CIs for this estimate.</p>
<pre class="r"><code>es_mental_rot_contrast &lt;- esci::estimateCorrelation.default(sex_diff_df_F, log_contrast, mental_rot)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_mental_rot_contrast</code></pre>
<p>We estimate the correlation between mental_rotation and log contrast thresholds in women as follows: r = -0.28 95% CI [-0.46, -0.09].</p>
</div>
<div id="men" class="section level4">
<h4>Men</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_M$log_contrast,
  sex_diff_df_M$mental_rot,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_M$log_contrast and sex_diff_df_M$mental_rot
## t = -1.334, df = 28, p-value = 0.09647
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.00000000  0.06694135
## sample estimates:
##        cor 
## -0.2444586</code></pre>
<p>Contrast thresholds do not significantly correlate with mental rotation scores in men.</p>
<p>We can use <code>esci</code> to provide CIs for this estimate.</p>
<pre class="r"><code>es_mental_rot_contrast &lt;- esci::estimateCorrelation.default(sex_diff_df_M, log_contrast, mental_rot)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_mental_rot_contrast</code></pre>
<p>We estimate the correlation between mental_rotation and log contrast thresholds in men as follows: r = -0.24 95% CI [-0.56, 0.13].</p>
</div>
</div>
<div id="motion-thresholds-and-mental-rotation" class="section level3">
<h3>Motion thresholds and mental rotation</h3>
<div id="women-1" class="section level4">
<h4>Women</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_F$log_motion,
  sex_diff_df_F$mental_rot,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_F$log_motion and sex_diff_df_F$mental_rot
## t = -3.2535, df = 95, p-value = 0.0007897
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.0000000 -0.1569305
## sample estimates:
##        cor 
## -0.3166253</code></pre>
<p>Log(motion duration) thresholds (negatively) correlate with mental rotation scores in women This means that lower thresholds (higher sensitivity) is associated with better performance in the mental rotation task.</p>
<p>We can use <code>esci</code> to provide CIs for this estimate.</p>
<pre class="r"><code>es_mental_rot_motion &lt;- esci::estimateCorrelation.default(sex_diff_df_F, log_motion, mental_rot)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_mental_rot_motion</code></pre>
<p>We estimate the correlation between mental_rotateion and log motion thresholds in women as follows: r = -0.32 95% CI [-0.49, -0.13].</p>
</div>
<div id="men-1" class="section level4">
<h4>Men</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_M$log_motion,
  sex_diff_df_M$mental_rot,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_M$log_motion and sex_diff_df_M$mental_rot
## t = 0.64141, df = 28, p-value = 0.7368
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.0000000  0.4115473
## sample estimates:
##       cor 
## 0.1203345</code></pre>
<p>Motion duration thresholds do not significantly correlate with mental rotation scores in men.</p>
<p>We can use <code>esci</code> to provide CIs for this estimate.</p>
<pre class="r"><code>es_mental_rot_motion &lt;- esci::estimateCorrelation.default(sex_diff_df_M, log_motion, mental_rot)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_mental_rot_motion</code></pre>
<p>We estimate the correlation between mental_rotation and log motion thresholds in men as follows: r = 0.12 95% CI [-0.25, 0.46]</p>
</div>
</div>
<div id="contrast-thresholds-and-male-typed-activities" class="section level3">
<h3>Contrast thresholds and male-typed activities</h3>
<div id="women-2" class="section level4">
<h4>Women</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_F$Masculine_hobbies,
  sex_diff_df_F$log_contrast,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_F$Masculine_hobbies and sex_diff_df_F$log_contrast
## t = -1.9424, df = 97, p-value = 0.02749
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.00000000 -0.02808275
## sample estimates:
##        cor 
## -0.1934967</code></pre>
<pre class="r"><code>es_contrast_m_hobbies &lt;- esci::estimateCorrelation.default(sex_diff_df_F, Masculine_hobbies, log_contrast)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_contrast_m_hobbies </code></pre>
<p>We estimate the correlation between log contrast and interest in male-typed activities in women as follows: r = -0.19 95% CI [-0.38, 0.00]</p>
</div>
<div id="men-2" class="section level4">
<h4>Men</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_M$Masculine_hobbies,
  sex_diff_df_M$log_contrast,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_M$Masculine_hobbies and sex_diff_df_M$log_contrast
## t = 1.137, df = 28, p-value = 0.8674
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.0000000  0.4852276
## sample estimates:
##       cor 
## 0.2100723</code></pre>
<pre class="r"><code>es_contrast_m_hobbies &lt;- esci::estimateCorrelation.default(sex_diff_df_M, Masculine_hobbies, log_contrast)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_contrast_m_hobbies</code></pre>
<p>We estimate the correlation between mental_rotation and interest in male-typed activities in men as follows: r = 0.21 95% CI [-0.16, 0.53]</p>
</div>
</div>
<div id="motion-thresholds-and-male-typed-activities" class="section level3">
<h3>Motion thresholds and male-typed activities</h3>
<div id="women-3" class="section level4">
<h4>Women</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_F$Masculine_hobbies,
  sex_diff_df_F$log_motion,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_F$Masculine_hobbies and sex_diff_df_F$log_motion
## t = 0.32894, df = 95, p-value = 0.6285
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.0000000  0.2006363
## sample estimates:
##        cor 
## 0.03372894</code></pre>
<pre class="r"><code>es_motion_m_hobbies &lt;- esci::estimateCorrelation.default(sex_diff_df_F, Masculine_hobbies, log_motion)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_motion_m_hobbies</code></pre>
<p>We estimate the correlation between log motion and interest in male-typed activities in women as follows: r = 0.03 95% CI [-0.17, 0.23]</p>
</div>
<div id="men-3" class="section level4">
<h4>Men</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_M$Masculine_hobbies,
  sex_diff_df_M$log_motion,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_M$Masculine_hobbies and sex_diff_df_M$log_motion
## t = 0.39651, df = 28, p-value = 0.6526
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.0000000  0.3725803
## sample estimates:
##        cor 
## 0.07472416</code></pre>
<pre class="r"><code>es_motion_m_hobbies &lt;- esci::estimateCorrelation.default(sex_diff_df_M, Masculine_hobbies, log_motion)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_mental_rot_motion</code></pre>
<p>We estimate the correlation between mental_rotation and interest in male-typed activities in men as follows: r = 0.07 95% CI [-0.29, 0.42]</p>
</div>
</div>
<div id="contrast-thresholds-and-motion-thresholds" class="section level3">
<h3>Contrast thresholds and motion thresholds</h3>
<div id="women-4" class="section level4">
<h4>Women</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_F$log_contrast,
  sex_diff_df_F$log_motion,
  method = &quot;pearson&quot;,
  alternative = &quot;greater&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_F$log_contrast and sex_diff_df_F$log_motion
## t = 1.4268, df = 94, p-value = 0.07848
## alternative hypothesis: true correlation is greater than 0
## 95 percent confidence interval:
##  -0.02392513  1.00000000
## sample estimates:
##       cor 
## 0.1455917</code></pre>
<p>The vision measures do not correlate in women.</p>
<p>We can use <code>esci</code> to provide CIs for this estimate.</p>
<pre class="r"><code>es_contrast_motion &lt;- esci::estimateCorrelation.default(sex_diff_df_F, log_contrast, log_motion)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_contrast_motion</code></pre>
<p>We estimate the correlation between log contrast and log motion thresholds in women as follows: r = 0.15 95% CI [-0.06, 0.34].</p>
</div>
<div id="men-4" class="section level4">
<h4>Men</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_M$log_contrast,
  sex_diff_df_M$log_motion,
  method = &quot;pearson&quot;,
  alternative = &quot;greater&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_M$log_contrast and sex_diff_df_M$log_motion
## t = 2.3575, df = 28, p-value = 0.01281
## alternative hypothesis: true correlation is greater than 0
## 95 percent confidence interval:
##  0.1149104 1.0000000
## sample estimates:
##       cor 
## 0.4069684</code></pre>
<p>The vision measures correlate in men.</p>
<p>We can use <code>esci</code> to provide CIs for this estimate.</p>
<pre class="r"><code>es_contrast_motion &lt;- esci::estimateCorrelation.default(sex_diff_df_M, log_contrast, log_motion)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_contrast_motion</code></pre>
<p>We estimate the correlation between log contrast and log motion thresholds in men as follows: r = 0.41 95% CI [0.05, 0.67].</p>
</div>
</div>
</div>
<div id="visualizations" class="section level2">
<h2>Visualizations</h2>
<pre class="r"><code># &quot;The APA has determined specifications for the size of figures and the fonts used in them. Figures of one column must be between 2 and 3.25 inches wide (5 to 8.45 cm). Two-column figures must be between 4.25 and 6.875 inches wide (10.6 to 17.5 cm). The height of figures should not exceed the top and bottom margins. The text in a figure should be in a san serif font (such as Helvetica, Arial, or Futura). The font size must be between eight and fourteen point. Use circles and squares to distinguish curves on a line graph (at the same font size as the other labels). &quot;
theme.custom &lt;- theme(panel.background = element_rect(fill = &quot;white&quot;, colour = &quot;grey50&quot;),
                      plot.title = element_text(size=12, face=&quot;bold&quot;,hjust = 0.5),
                      axis.title.x = element_text(size=10),
                      axis.title.y = element_text(size=10),
                      strip.text = element_text(size=9),
                      axis.text = element_text(size=9),
                      legend.position = &quot;bottom&quot;,
                       legend.title = element_blank(),
#  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
                      legend.text=element_text(size=9))</code></pre>
<p>The following scatterplots are formatted so that higher sensitivity on the visual tasks (lower log thresholds) are to the right.</p>
<pre class="r"><code>sex_diff_scatter &lt;-
  function(df,
           x_var,
           y_var,
           x_rev = FALSE,
           y_rev = FALSE,
           an_f = &quot;&quot;,
           an_m = &quot;&quot;,
           anx = NULL,
           any = NULL,
           x_lab = &quot;X axis&quot;,
           y_lab = &quot;Y axis&quot;,
           square_axis = TRUE,
           margin_type = &quot;boxplot&quot;
           ) {
    require(tidyverse)
    require(ggExtra)
    
    x_var_s &lt;- sym(x_var)
    y_var_s &lt;- sym(y_var)
    
    p &lt;- ggplot(df) +
      aes(
        x = !!x_var_s,
        y = !!y_var_s,
        group = Sex,
        color = Sex
      ) +
      geom_point(size=4) +
      xlab(x_var) +
      ylab(y_var) +
      stat_smooth(method = &quot;lm&quot;, na.rm = TRUE) +
      xlab(x_lab) +
      ylab(y_lab)+
      theme.custom +
      scale_colour_grey(start=0,end=0.5) +
     annotate(
        &quot;text&quot;,
        x = anx,
        y = any,
        size=6,
        label = c(an_f, an_m), color=gray.colors(2, start = 0, end = 0.5),
             hjust = 1
      ) 
    
    if (square_axis)
    {
      p + coord_fixed() + theme(asp.ratio = 1)
    }
    
    if (stringr::str_detect(x_var, &#39;hobbies&#39;)) {
      p &lt;- p + xlim(1, 5)
    }
    if (stringr::str_detect(y_var, &#39;hobbies&#39;)) {
      p &lt;- p + ylim(1, 5)
    }
    
    # Reverse scale for threshold measures?
    if (x_rev)
      p &lt;- p + scale_x_reverse()
    if (y_rev)
      p &lt;- p + scale_y_reverse()
    
    p1 &lt;- ggExtra::ggMarginal(p,
                              type = margin_type,
                              margins = &quot;both&quot;,
                              groupFill = TRUE)
    p1
  }</code></pre>
<p>Create matrices of correlation coefficients for subsequent plotting.</p>
<pre class="r"><code>corr_vars &lt;- c(&#39;log_contrast&#39;, &#39;log_motion&#39;, &#39;mental_rot&#39;, &#39;Masculine_hobbies&#39;)
df_corr_F &lt;- sex_diff_df_F %&gt;%
  dplyr::select(., corr_vars)</code></pre>
<pre><code>## Note: Using an external vector in selections is ambiguous.
## ℹ Use `all_of(corr_vars)` instead of `corr_vars` to silence this message.
## ℹ See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.
## This message is displayed once per session.</code></pre>
<pre class="r"><code>corr_F &lt;- Hmisc::rcorr(as.matrix(df_corr_F), type = c(&quot;pearson&quot;))

df_corr_M &lt;- sex_diff_df_M %&gt;%
  dplyr::select(., corr_vars)

corr_M &lt;- Hmisc::rcorr(as.matrix(df_corr_M), type = c(&quot;pearson&quot;))

df_corr_all &lt;- sex_diff_df %&gt;%
  dplyr::select(., corr_vars)

corr_all &lt;- Hmisc::rcorr(as.matrix(df_corr_all), type = c(&quot;pearson&quot;))</code></pre>
<p>Create a helper function to generate and plot correlation coefficients.</p>
<pre class="r"><code>sex_diff_corr_summ &lt;- function(x_var, y_var, print_table = TRUE, 
                               corr_all_df = corr_all,
                               corr_M_df = corr_M,
                               corr_F_df = corr_F,
                               show_combined = FALSE) {
  require(tidyverse) # for %&gt;%
  
  corr_all_df &lt;- tibble::tibble(
    cor_coef = corr_all_df$r[x_var, y_var],
    p_val = corr_all_df$P[x_var, y_var],
    n =  corr_all_df$n[x_var, y_var],
    pop = &quot;Both&quot;
  )
  males_df &lt;- tibble::tibble(
    cor_coef = corr_M_df$r[x_var, y_var],
    p_val = corr_M_df$P[x_var, y_var],
    n =  corr_M_df$n[x_var, y_var],
    pop = &quot;Males&quot;
  )
  
  females_df &lt;- tibble::tibble(
    cor_coef = corr_F_df$r[x_var, y_var],
    p_val = corr_F_df$P[x_var, y_var],
    n =  corr_F_df$n[x_var, y_var],
    pop = &quot;Females&quot;
  )
  
  if (show_combined) {
    df &lt;- rbind(corr_all_df, males_df, females_df)
  } else {
    df &lt;- rbind(males_df, females_df)
  }
  
  # Add stars for significance levels
  df &lt;- df %&gt;%
    mutate(., stars = if_else(p_val &lt; .005, &quot;***&quot;,
                              if_else(
                                p_val &lt; .01, &quot;**&quot;,
                                if_else(p_val &lt; .05, &quot;*&quot;, &quot; ns&quot;)
                              )))
  
  if (print_table) {
    kableExtra::kable(df, format = &#39;html&#39;) %&gt;%
      kableExtra::kable_styling()
  } else {
    df
  }
}</code></pre>
<div id="contrast-mental-rotation" class="section level3">
<h3>Contrast &amp; mental rotation</h3>
<pre class="r"><code>corr_df &lt;- sex_diff_corr_summ(&quot;log_contrast&quot;, &quot;mental_rot&quot;,
                              corr_all,
                              corr_M_df = corr_M,
                              corr_F_df = corr_F,
                              print_table = FALSE)

p1&lt;-sex_diff_scatter(
  sex_diff_df,
  &quot;log_contrast&quot;,
  &quot;mental_rot&quot;,
  x_rev = FALSE,
  y_rev = FALSE,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[1], digits = 2, nsmall = 2),
    corr_df$stars[1]
  ),
  c(-1.2),
  c(12, 38),
  &quot;log(contrast threshold)&quot;,
  &quot;Mental rotation score&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 3 rows containing missing values (geom_point).</code></pre>
<pre class="r"><code>p1</code></pre>
<p><img src="img/contrast-sens-mental-rot-1.png" width="2100" style="display: block; margin: auto;" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;log_contrast&quot;, &quot;mental_rot&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.2444586
</td>
<td style="text-align:right;">
0.1929443
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.2838364
</td>
<td style="text-align:right;">
0.0044124
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
</div>
<div id="motion-mental-rotation" class="section level3">
<h3>Motion &amp; mental rotation</h3>
<pre class="r"><code>sex_diff_scatter_2 &lt;-
  function(df,
           x_var,
           y_var,
           x_rev = FALSE,
           y_rev = FALSE,
           an_f = &quot;&quot;,
           an_m = &quot;&quot;,
           anx = NULL,
           any = NULL,
           x_lab = &quot;X axis&quot;,
           y_lab = &quot;Y axis&quot;,
           square_axis = TRUE,
           margin_type = &quot;boxplot&quot;) {
    require(tidyverse)
    require(ggExtra)
    
    x_var_s &lt;- sym(x_var)
    y_var_s &lt;- sym(y_var)
    
    p &lt;- ggplot(df) +
      aes(
        x = !!x_var_s,
        y = !!y_var_s,
        group = Sex,
        color = Sex
      ) +
      geom_point(size=4) +
      xlab(x_var) +
      ylab(y_var) +
      stat_smooth(method = &quot;lm&quot;, na.rm = TRUE) +
     theme.custom +
      xlab(x_lab) +
      ylab(y_lab) +
      scale_colour_grey(start=0,end=0.5)+
      annotate(
        &quot;text&quot;,
        x = anx,
        y = any,
        size=6,
        label = c(an_f, an_m), color=gray.colors(2, start = 0, end = 0.5),
             hjust = 1
      )

    # if (show_corr_vals) {
    #   p + annotate(
    #     &quot;text&quot;,
    #     x = anx,
    #     y = any,
    #     label = c(an_f, an_m),
    #     color = c(&#39;red&#39;, &#39;darkturquoise&#39;)
    #   )
    # }
    # 
    # if (square_axis)
    # {
    #   p + coord_fixed() + theme(asp.ratio = 1)
    # }
    # 
    # if (stringr::str_detect(x_var, &#39;hobbies&#39;)) {
    #   p &lt;- p + xlim(1, 5)
    # }
    # if (stringr::str_detect(y_var, &#39;hobbies&#39;)) {
    #   p &lt;- p + ylim(1, 5)
    # }
    # 
    # # Reverse scale for threshold measures?
    # if (x_rev)
    #   p &lt;- p + scale_x_reverse()
    # if (y_rev)
    #   p &lt;- p + scale_y_reverse()
    # 
    # p1 &lt;- ggExtra::ggMarginal(p,
    #                           type = margin_type,
    #                           margins = &quot;both&quot;,
    #                           groupFill = TRUE)
    p
  }</code></pre>
<pre class="r"><code>corr_df &lt;- sex_diff_corr_summ(&quot;log_motion&quot;,
                              &quot;mental_rot&quot;, print_table = FALSE)

p_motion &lt;- sex_diff_scatter_2(
  sex_diff_df,
  &quot;log_motion&quot;,
  &quot;mental_rot&quot;,
  x_rev = FALSE,
  y_rev = FALSE,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[1], digits = 2, nsmall = 2),
    corr_df$stars[1]
  ),
  c(-0.9),
  c(12, 38),
  &quot;log(motion threshold)&quot;,
  &quot;Mental rotation score&quot;
)

# p_motion &lt;- sex_diff_scatter(
#   sex_diff_df,
#   &quot;log_motion&quot;,
#   &quot;mental_rot&quot;,
#   x_rev = FALSE,
#   y_rev = FALSE,
#   paste0(
#     &quot;r = &quot;,
#     format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
#     corr_df$stars[3]
#   ),
#   paste0(
#     &quot;r = &quot;,
#     format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
#     corr_df$stars[2]
#   ),
#   c(-1.8,-1.9),
#   c(30, 36),
#   &quot;log(motion threshold)&quot;,
#   &quot;Mental rotation score&quot;
# )

p_aug &lt;- p_motion +
  ggplot2::annotate(
    geom = &quot;point&quot;,
    x = sex_diff_df$log_motion[c(115, 118)],
    y = sex_diff_df$mental_rot[c(115, 118)],
    color = &quot;black&quot;,
    size = 8,
    shape = 0
  )

p_aug &lt;- ggExtra::ggMarginal(p_aug,
                             type = &quot;boxplot&quot;,
                             margins = &quot;both&quot;,
                             groupFill = TRUE)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 5 rows containing missing values (geom_point).</code></pre>
<pre class="r"><code>p_aug</code></pre>
<p><img src="img/motion-duration-mental-rot-annotate-outliers-1.png" width="2100" style="display: block; margin: auto;" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;log_motion&quot;, &quot;mental_rot&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.1203345
</td>
<td style="text-align:right;">
0.5264717
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.3166253
</td>
<td style="text-align:right;">
0.0015794
</td>
<td style="text-align:right;">
97
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
</div>
<div id="contrast-male-typed-interests" class="section level3">
<h3>Contrast &amp; male-typed interests</h3>
<pre class="r"><code>corr_df &lt;- sex_diff_corr_summ(&quot;log_contrast&quot;, &quot;Masculine_hobbies&quot;,
                              corr_all,
                              corr_M_df = corr_M,
                              corr_F_df = corr_F,
                              print_table = FALSE)

p3&lt;-sex_diff_scatter(
  sex_diff_df,
  &quot;log_contrast&quot;,
  &quot;Masculine_hobbies&quot;,
  x_rev = FALSE,
  y_rev = FALSE,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    &quot;*&quot;
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[1], digits = 2, nsmall = 2),
    corr_df$stars[1]
  ),
  c(-1.2),
  c(1.2, 4.8),
  &quot;log(contrast threshold)&quot;,
  &quot;Interest in male-typed activities&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 3 rows containing missing values (geom_point).</code></pre>
<pre class="r"><code>p3</code></pre>
<p><img src="img/contrast-sens-male-hobbies-1.png" width="2100" style="display: block; margin: auto;" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;log_contrast&quot;, &quot;Masculine_hobbies&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.2100723
</td>
<td style="text-align:right;">
0.2651882
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.1934967
</td>
<td style="text-align:right;">
0.0549851
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
ns
</td>
</tr>
</tbody>
</table>
</div>
<div id="motion-contrast" class="section level3">
<h3>Motion &amp; contrast</h3>
<pre class="r"><code>corr_df &lt;- sex_diff_corr_summ(&quot;log_motion&quot;,
                              &quot;log_contrast&quot;, print_table = FALSE)

p_vision&lt;-sex_diff_scatter_2(
  sex_diff_df,
  &quot;log_motion&quot;,
  &quot;log_contrast&quot;,
  x_rev = FALSE,
  y_rev = FALSE,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[1], digits = 2, nsmall = 2),
    corr_df$stars[1]
  ),
  c(-0.8),
  c(-1.96,-1.3),
  &quot;log(motion threshold)&quot;,
  &quot;log(contrast threshold)&quot;
)

p_aug2 &lt;- p_vision +
  ggplot2::annotate(
    geom = &quot;point&quot;,
    x = sex_diff_df$log_motion[c(115, 118)],
    y = sex_diff_df$log_contrast[c(115, 118)],
    color = &quot;black&quot;,
    size = 8,
    shape = 0
  )

p_aug2 &lt;- ggExtra::ggMarginal(p_aug2,
                             type = &quot;boxplot&quot;,
                             margins = &quot;both&quot;,
                             groupFill = TRUE)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 6 rows containing missing values (geom_point).</code></pre>
<pre class="r"><code>p_aug2</code></pre>
<p><img src="img/motion-duration-contrast-sens-1.png" width="2100" style="display: block; margin: auto;" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;log_motion&quot;,
                   &quot;log_contrast&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.4069684
</td>
<td style="text-align:right;">
0.0256180
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:right;">
0.1455917
</td>
<td style="text-align:right;">
0.1569604
</td>
<td style="text-align:right;">
96
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
ns
</td>
</tr>
</tbody>
</table></li>
</ul>
<pre class="r"><code>library(&quot;gridExtra&quot;)
p = grid.arrange(ncol = 2, nrow = 2, p1, p_aug, p3,p_aug2)</code></pre>
<p><img src="img/unnamed-chunk-52-1.png" width="2100" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggsave(
  plot = p,
  filename = paste0(&quot;~/Desktop/fig2.png&quot;),
  units = &quot;in&quot;,
  height = 12,
  width = 12,
  dpi = 600
)</code></pre>
</div>
</div>
</div>
<div id="non-pregistered-analyses" class="section level1">
<h1>Non-pregistered analyses</h1>
<div id="does-vision-account-for-mental-rotation" class="section level2">
<h2>Does vision account for mental rotation?</h2>
<p>One can model <code>mental rotation ~ contrast + motion + sex</code> and determine whether adding the <code>sex</code> term or its interactions provides a better fit than the vision measures.</p>
<div id="model-based-approach" class="section level3">
<h3>Model-based approach</h3>
<pre class="r"><code>df_mr_contr_motion &lt;- sex_diff_df %&gt;%
  dplyr::select(., mental_rot, log_contrast, log_motion, Sex, Masculine_hobbies) %&gt;%
  dplyr::filter(., !is.na(Sex),
                !is.na(log_contrast),
                !is.na(log_motion),
                !is.na(mental_rot))

# Export for relative weight analysis (RWA)
readr::write_csv(df_mr_contr_motion, file = file.path(params$data_path, &#39;mr-contr-motion-sex.csv&#39;))</code></pre>
<div id="model-0-mental_rot-log_contrastlog_motionsex" class="section level4">
<h4>Model 0: <code>mental_rot ~ log_contrast*log_motion*Sex</code></h4>
<p>Let’s fit a full model with all interactions:</p>
<pre class="r"><code>lm_mr_contr_motion_sex_full &lt;- lm(mental_rot ~ log_contrast*log_motion*Sex, data = df_mr_contr_motion)
summary(lm_mr_contr_motion_sex_full)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast * log_motion * Sex, data = df_mr_contr_motion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -14.3999  -3.7147  -0.1083   3.3877  12.0877 
## 
## Coefficients:
##                                 Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                       -24.30      59.33  -0.409    0.683
## log_contrast                      -20.43      34.16  -0.598    0.551
## log_motion                        -17.08      26.40  -0.647    0.519
## SexMale                           -56.73      98.86  -0.574    0.567
## log_contrast:log_motion            -5.99      15.16  -0.395    0.693
## log_contrast:SexMale              -52.77      57.80  -0.913    0.363
## log_motion:SexMale                -22.18      45.59  -0.486    0.628
## log_contrast:log_motion:SexMale   -20.56      26.30  -0.782    0.436
## 
## Residual standard error: 5.682 on 117 degrees of freedom
## Multiple R-squared:  0.1913, Adjusted R-squared:  0.143 
## F-statistic: 3.955 on 7 and 117 DF,  p-value: 0.0006531</code></pre>
<pre class="r"><code>car::Anova(lm_mr_contr_motion_sex_full)</code></pre>
<pre><code>## Anova Table (Type II tests)
## 
## Response: mental_rot
##                             Sum Sq  Df F value   Pr(&gt;F)   
## log_contrast                 214.7   1  6.6513 0.011148 * 
## log_motion                   113.5   1  3.5173 0.063223 . 
## Sex                           96.7   1  2.9941 0.086205 . 
## log_contrast:log_motion       34.6   1  1.0709 0.302880   
## log_contrast:Sex              23.9   1  0.7403 0.391322   
## log_motion:Sex               222.9   1  6.9053 0.009746 **
## log_contrast:log_motion:Sex   19.7   1  0.6110 0.435983   
## Residuals                   3777.1 117                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>confint(lm_mr_contr_motion_sex_full)</code></pre>
<pre><code>##                                      2.5 %    97.5 %
## (Intercept)                     -141.79397  93.20481
## log_contrast                     -88.08265  47.22010
## log_motion                       -69.36066  35.20288
## SexMale                         -252.52312 139.05713
## log_contrast:log_motion          -36.00901  24.02970
## log_contrast:SexMale            -167.24730  61.70843
## log_motion:SexMale              -112.47290  68.11721
## log_contrast:log_motion:SexMale  -72.64318  31.52737</code></pre>
<pre class="r"><code>lsr::etaSquared(lm_mr_contr_motion_sex_full)</code></pre>
<pre><code>##                                  eta.sq eta.sq.part
## log_contrast                0.045970898 0.053790602
## log_motion                  0.024310297 0.029185210
## Sex                         0.020693990 0.024952058
## log_contrast:log_motion     0.007401522 0.009069853
## log_contrast:Sex            0.005116695 0.006287621
## log_motion:Sex              0.047726746 0.055730622
## log_contrast:log_motion:Sex 0.004223110 0.005195250</code></pre>
</div>
<div id="model-1-mental_rot-log_contrast-log_motion-sex-log_motionsex" class="section level4">
<h4>Model 1: <code>mental_rot ~ log_contrast + log_motion + Sex + log_motion:Sex</code></h4>
<p>Keep only components that meet a <span class="math inline">\(p&lt;.1\)</span> criterion.</p>
<pre class="r"><code>lm_mr_contr_motion_motion_sex_int &lt;- lm(mental_rot ~ log_contrast + log_motion + Sex + log_motion:Sex, data = df_mr_contr_motion)
summary(lm_mr_contr_motion_motion_sex_int)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast + log_motion + Sex + log_motion:Sex, 
##     data = df_mr_contr_motion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -13.1938  -3.9686  -0.2294   3.6811  12.0590 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)          -3.010      7.206  -0.418   0.6769   
## log_contrast         -8.295      3.212  -2.582   0.0110 * 
## log_motion           -6.564      2.332  -2.815   0.0057 **
## SexMale              28.818     11.364   2.536   0.0125 * 
## log_motion:SexMale   11.169      4.693   2.380   0.0189 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.675 on 120 degrees of freedom
## Multiple R-squared:  0.1725, Adjusted R-squared:  0.1449 
## F-statistic: 6.255 on 4 and 120 DF,  p-value: 0.000132</code></pre>
<pre class="r"><code>car::Anova(lm_mr_contr_motion_motion_sex_int)</code></pre>
<pre><code>## Anova Table (Type II tests)
## 
## Response: mental_rot
##                Sum Sq  Df F value  Pr(&gt;F)  
## log_contrast    214.7   1  6.6666 0.01103 *
## log_motion      117.5   1  3.6470 0.05856 .
## Sex              76.0   1  2.3599 0.12712  
## log_motion:Sex  182.5   1  5.6650 0.01888 *
## Residuals      3865.0 120                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>confint(lm_mr_contr_motion_motion_sex_int)</code></pre>
<pre><code>##                         2.5 %    97.5 %
## (Intercept)        -17.277886 11.257847
## log_contrast       -14.655001 -1.934077
## log_motion         -11.180411 -1.947654
## SexMale              6.316888 51.318118
## log_motion:SexMale   1.878016 20.460301</code></pre>
<pre class="r"><code>lsr::etaSquared(lm_mr_contr_motion_motion_sex_int)</code></pre>
<pre><code>##                    eta.sq eta.sq.part
## log_contrast   0.04597090  0.05263138
## log_motion     0.02514835  0.02949511
## Sex            0.01627327  0.01928678
## log_motion:Sex 0.03906416  0.04508043</code></pre>
<p>Compare the fit of the reduced model to the fuller model.</p>
<pre class="r"><code>anova(lm_mr_contr_motion_sex_full, lm_mr_contr_motion_motion_sex_int)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: mental_rot ~ log_contrast * log_motion * Sex
## Model 2: mental_rot ~ log_contrast + log_motion + Sex + log_motion:Sex
##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
## 1    117 3777.1                           
## 2    120 3865.0 -3    -87.92 0.9078 0.4396</code></pre>
<p>We choose the simpler model for parsimony reasons and a reduction in RSS even though the fit does not improve to a substantial degree.</p>
</div>
<div id="model-2-mental_rot-log_contrast-log_motion" class="section level4">
<h4>Model 2: <code>mental_rot ~ log_contrast + log_motion</code></h4>
<p>Let’s drop <code>Sex</code>because its effect is small, and the <code>log_motion:Sex</code> interaction to see whether these improve the fit.</p>
<pre class="r"><code>lm_mr_contr_motion_no_sex &lt;- lm(mental_rot ~ log_contrast + log_motion, data = df_mr_contr_motion)
summary(lm_mr_contr_motion_no_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast + log_motion, data = df_mr_contr_motion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -13.2734  -4.0444  -0.2688   3.3211  14.5612 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)     1.268      6.477   0.196   0.8451  
## log_contrast   -8.470      3.243  -2.612   0.0101 *
## log_motion     -4.727      2.026  -2.333   0.0213 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.814 on 122 degrees of freedom
## Multiple R-squared:  0.1172, Adjusted R-squared:  0.1027 
## F-statistic: 8.097 on 2 and 122 DF,  p-value: 0.000499</code></pre>
<pre class="r"><code>car::Anova(lm_mr_contr_motion_no_sex)</code></pre>
<pre><code>## Anova Table (Type II tests)
## 
## Response: mental_rot
##              Sum Sq  Df F value  Pr(&gt;F)  
## log_contrast  230.6   1  6.8234 0.01013 *
## log_motion    184.0   1  5.4433 0.02128 *
## Residuals    4123.5 122                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>confint(lm_mr_contr_motion_no_sex)</code></pre>
<pre><code>##                   2.5 %     97.5 %
## (Intercept)  -11.554100 14.0899548
## log_contrast -14.889265 -2.0511391
## log_motion    -8.737419 -0.7161637</code></pre>
<pre class="r"><code>lsr::etaSquared(lm_mr_contr_motion_no_sex)</code></pre>
<pre><code>##                  eta.sq eta.sq.part
## log_contrast 0.04937532  0.05296689
## log_motion   0.03938889  0.04271161</code></pre>
<p>Compare this model to the fuller one.</p>
<pre class="r"><code>anova(lm_mr_contr_motion_motion_sex_int, lm_mr_contr_motion_no_sex)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: mental_rot ~ log_contrast + log_motion + Sex + log_motion:Sex
## Model 2: mental_rot ~ log_contrast + log_motion
##   Res.Df    RSS Df Sum of Sq      F  Pr(&gt;F)  
## 1    120 3865.0                              
## 2    122 4123.5 -2   -258.47 4.0125 0.02057 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>So, the fit of the fuller model with <code>Sex</code> and the <code>log_motion:Sex</code> interaction included is better.</p>
</div>
<div id="model-3-mental_rot-log_contrast-sex" class="section level4">
<h4>Model 3: <code>mental_rot ~ log_contrast + Sex</code></h4>
<p>Let’s try dropping <code>log_motion</code> and the <code>Sex:log_motion</code> interaction.</p>
<pre class="r"><code>lm_mr_contr_no_motion_sex &lt;- lm(mental_rot ~ log_contrast + Sex, data = df_mr_contr_motion)
summary(lm_mr_contr_no_motion_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast + Sex, data = df_mr_contr_motion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -12.5807  -3.9650  -0.3953   4.1979  13.3733 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)    10.847      5.679   1.910   0.0585 . 
## log_contrast   -8.894      3.236  -2.748   0.0069 **
## SexMale         2.560      1.253   2.043   0.0432 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.843 on 122 degrees of freedom
## Multiple R-squared:  0.1083, Adjusted R-squared:  0.09369 
## F-statistic: 7.409 on 2 and 122 DF,  p-value: 0.0009186</code></pre>
<pre class="r"><code>car::Anova(lm_mr_contr_no_motion_sex)</code></pre>
<pre><code>## Anova Table (Type II tests)
## 
## Response: mental_rot
##              Sum Sq  Df F value  Pr(&gt;F)   
## log_contrast  257.9   1  7.5532 0.00690 **
## Sex           142.5   1  4.1749 0.04318 * 
## Residuals    4164.9 122                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>confint(lm_mr_contr_no_motion_sex)</code></pre>
<pre><code>##                     2.5 %    97.5 %
## (Intercept)   -0.39651793 22.089699
## log_contrast -15.30009069 -2.487655
## SexMale        0.07973661  5.039821</code></pre>
<pre class="r"><code>lsr::etaSquared(lm_mr_contr_no_motion_sex)</code></pre>
<pre><code>##                  eta.sq eta.sq.part
## log_contrast 0.05520626  0.05830221
## Sex          0.03051382  0.03308787</code></pre>
<p>Compare this reduced model to the fuller one.</p>
<pre class="r"><code>anova(lm_mr_contr_motion_motion_sex_int, lm_mr_contr_no_motion_sex)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: mental_rot ~ log_contrast + log_motion + Sex + log_motion:Sex
## Model 2: mental_rot ~ log_contrast + Sex
##   Res.Df    RSS Df Sum of Sq     F  Pr(&gt;F)  
## 1    120 3865.0                             
## 2    122 4164.9 -2   -299.92 4.656 0.01129 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The full model still is a better fit.</p>
</div>
<div id="model-4-mental_rot-sex" class="section level4">
<h4>Model 4: <code>mental_rot ~ Sex</code></h4>
<p>Finally, let’s drop the vision variables.</p>
<pre class="r"><code>lm_mr_no_vision_sex &lt;- lm(mental_rot ~ Sex, data = df_mr_contr_motion)
summary(lm_mr_no_vision_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ Sex, data = df_mr_contr_motion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -11.6667  -3.6667  -0.3684   3.6316  13.6316 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  26.3684     0.6152  42.860  &lt; 2e-16 ***
## SexMale       3.2982     1.2558   2.626  0.00973 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.996 on 123 degrees of freedom
## Multiple R-squared:  0.0531, Adjusted R-squared:  0.0454 
## F-statistic: 6.898 on 1 and 123 DF,  p-value: 0.009727</code></pre>
<pre class="r"><code>car::Anova(lm_mr_no_vision_sex)</code></pre>
<pre><code>## Anova Table (Type II tests)
## 
## Response: mental_rot
##           Sum Sq  Df F value   Pr(&gt;F)   
## Sex        248.0   1  6.8978 0.009727 **
## Residuals 4422.8 123                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>confint(lm_mr_no_vision_sex)</code></pre>
<pre><code>##                  2.5 %    97.5 %
## (Intercept) 25.1506239 27.586218
## SexMale      0.8124275  5.784064</code></pre>
<pre class="r"><code>lsr::etaSquared(lm_mr_no_vision_sex)</code></pre>
<pre><code>##         eta.sq eta.sq.part
## Sex 0.05310184  0.05310184</code></pre>
<pre class="r"><code>anova(lm_mr_contr_motion_motion_sex_int, lm_mr_no_vision_sex)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: mental_rot ~ log_contrast + log_motion + Sex + log_motion:Sex
## Model 2: mental_rot ~ Sex
##   Res.Df    RSS Df Sum of Sq      F   Pr(&gt;F)   
## 1    120 3865.0                                
## 2    123 4422.8 -3   -557.78 5.7727 0.001011 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Again, the full model containing the vision measures and sex is the best-fitting.</p>
</div>
<div id="relative-weight-analysis-rwa" class="section level4">
<h4>Relative Weight Analysis (RWA)</h4>
<p>We conducted a Relative Weight Analysis that is described in a separate file &lt;relative-weight-analysis.html&gt;.</p>
</div>
</div>
</div>
<div id="do-outliers-account-for-results" class="section level2">
<h2>Do outliers account for results?</h2>
<p>The scatterplots indicate that despite the log transformation, there are some individual participants who had especially high thresholds for contrast and motion duration.</p>
<p>Do our results hold when we trim the data to focus on those individuals whose data are within 3 standard deviations of the mean log threshold?</p>
<p>We define a helper function to detect outliers.</p>
<pre class="r"><code>FindOutliers &lt;- function(data, sd_thresh = as.numeric(params$outlier_sd_thresh)) {
  sd = sd(data, na.rm = T)
  mean = mean(data, na.rm = T)
  # we identify extreme outliers
  extreme.threshold.upper = (sd * sd_thresh) + mean
  extreme.threshold.lower = -(sd * sd_thresh) + mean
  result &lt;-
    which(data &gt; extreme.threshold.upper |
            data &lt; extreme.threshold.lower)
  print(result)
}

#all_outliers &lt;- lapply(sex_diff_df, FindOutliers)</code></pre>
<div id="visual-perception-thresholds-1" class="section level3">
<h3>Visual perception thresholds</h3>
<div id="contrast-thresholds-1" class="section level4">
<h4>Contrast thresholds</h4>
<p>We detect outliers in contrast threshold.</p>
<pre class="r"><code>FindOutliers(sex_diff_df$log_contrast)</code></pre>
<pre><code>## integer(0)</code></pre>
<p>No contrast thresholds exceed the criterion.</p>
</div>
<div id="motion-duration-thresholds-1" class="section level4">
<h4>Motion duration thresholds</h4>
<pre class="r"><code>FindOutliers(sex_diff_df$log_motion)</code></pre>
<pre><code>## [1] 115 118</code></pre>
<p>Two cases exceed the criterion for motion.</p>
<p>Create a new trimmed data frame.</p>
<pre class="r"><code>df_trimmed &lt;- sex_diff_df[-c(FindOutliers(sex_diff_df$log_motion)),]</code></pre>
<pre><code>## [1] 115 118</code></pre>
<pre class="r"><code>xtabs(~ Sex, df_trimmed)</code></pre>
<pre><code>## Sex
## Female   Male 
##    100     30</code></pre>
<pre class="r"><code>df_trimmed %&gt;%
  ggplot() +
  aes(Sex, log_motion) +
  geom_boxplot()</code></pre>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="img/unnamed-chunk-68-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>We then test for a difference in means.</p>
<pre class="r"><code>mdt_tt &lt;-
  t.test(
    log_motion ~ Sex,
    data = df_trimmed,
    var.equal = TRUE,
    alternative = &quot;greater&quot;
  ) # Hypothesized
mdt_tt</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  log_motion by Sex
## t = 3.7359, df = 124, p-value = 0.000142
## alternative hypothesis: true difference in means between group Female and group Male is greater than 0
## 95 percent confidence interval:
##  0.089656      Inf
## sample estimates:
## mean in group Female   mean in group Male 
##            -2.293820            -2.454955</code></pre>
<p>Women still have larger motion duration threshold than men.</p>
</div>
</div>
<div id="mental-rotation" class="section level3">
<h3>Mental rotation</h3>
<pre class="r"><code>FindOutliers(sex_diff_df$mental_rot)</code></pre>
<pre><code>## integer(0)</code></pre>
<p>There were no outliers in mental rotation.</p>
</div>
<div id="vocabulary" class="section level3">
<h3>Vocabulary</h3>
<pre class="r"><code>FindOutliers(sex_diff_df$vocab)</code></pre>
<pre><code>## integer(0)</code></pre>
<p>There were no outliers in vocabulary.</p>
</div>
<div id="correlations-among-measures-1" class="section level3">
<h3>Correlations among measures</h3>
<p>Since trimming outliers only affected the motion threshold data, we focus on that measure.</p>
<pre class="r"><code>sex_diff_df_F &lt;- df_trimmed %&gt;%
  dplyr::filter(., Sex == &quot;Female&quot;)

sex_diff_df_M &lt;- df_trimmed %&gt;%
  dplyr::filter(., Sex == &quot;Male&quot;)</code></pre>
<div id="motion-thresholds-and-mental-rotation-1" class="section level4">
<h4>Motion thresholds and mental rotation</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_F$log_motion,
  sex_diff_df_F$mental_rot,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_F$log_motion and sex_diff_df_F$mental_rot
## t = -3.0141, df = 93, p-value = 0.001661
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.0000000 -0.1353437
## sample estimates:
##        cor 
## -0.2983134</code></pre>
<p>Log(motion duration) thresholds (negatively) correlate with mental rotation scores in women, even after trimming.</p>
<pre class="r"><code>cor.test(
  sex_diff_df_M$log_motion,
  sex_diff_df_M$mental_rot,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_M$log_motion and sex_diff_df_M$mental_rot
## t = 0.64141, df = 28, p-value = 0.7368
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.0000000  0.4115473
## sample estimates:
##       cor 
## 0.1203345</code></pre>
<p>Motion duration thresholds do not correlate with mental rotation scores in men.</p>
</div>
<div id="contrast-thresholds-and-motion-thresholds-1" class="section level4">
<h4>Contrast thresholds and motion thresholds</h4>
<div id="women-5" class="section level5">
<h5>Women</h5>
<pre class="r"><code>cor.test(
  sex_diff_df_F$log_contrast,
  sex_diff_df_F$log_motion,
  method = &quot;pearson&quot;,
  alternative = &quot;greater&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_F$log_contrast and sex_diff_df_F$log_motion
## t = 2.0919, df = 92, p-value = 0.0196
## alternative hypothesis: true correlation is greater than 0
## 95 percent confidence interval:
##  0.0439443 1.0000000
## sample estimates:
##       cor 
## 0.2130843</code></pre>
<p>The vision measures now correlate in women.</p>
<pre class="r"><code>es_contrast_motion &lt;- esci::estimateCorrelation.default(sex_diff_df_F, log_contrast, log_motion)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_contrast_motion</code></pre>
<p>We find that a correlation between log contrast and log motion thresholds in women is as follows: r = 0.21 95% CI [0.01, 0.40].</p>
</div>
<div id="men-5" class="section level5">
<h5>Men</h5>
<pre class="r"><code>cor.test(
  sex_diff_df_M$log_contrast,
  sex_diff_df_M$log_motion,
  method = &quot;pearson&quot;,
  alternative = &quot;greater&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_M$log_contrast and sex_diff_df_M$log_motion
## t = 2.3575, df = 28, p-value = 0.01281
## alternative hypothesis: true correlation is greater than 0
## 95 percent confidence interval:
##  0.1149104 1.0000000
## sample estimates:
##       cor 
## 0.4069684</code></pre>
<p>The vision measures still correlate in men.</p>
</div>
</div>
</div>
<div id="modeling-mental-rotation" class="section level3">
<h3>Modeling mental rotation</h3>
<p>Do the <em>trimmed data</em> show a stronger relationship between vision and mental rotation than sex and mental rotation?</p>
<pre class="r"><code>df_mr_contr_motion &lt;- df_trimmed %&gt;%
  dplyr::select(., Sex, log_contrast, log_motion, mental_rot) %&gt;%
  dplyr::filter(., !is.na(Sex),
                !is.na(log_contrast),
                !is.na(log_motion),
                !is.na(mental_rot))

# Export for relative weight analysis (RWA)
readr::write_csv(df_mr_contr_motion, file = file.path(params$data_path, &#39;mr-contr-motion-sex-trimmed.csv&#39;))</code></pre>
<div id="model-2-mental_rot-log_contrast-log_motion-sex-log_motionsex" class="section level4">
<h4>Model 2: <code>mental_rot ~ log_contrast + log_motion + Sex + log_motion:Sex</code></h4>
<pre class="r"><code>lm_mr_contr_motion_motion_sex_int &lt;- lm(mental_rot ~ log_contrast + log_motion + Sex + log_motion:Sex, data = df_mr_contr_motion)
summary(lm_mr_contr_motion_motion_sex_int)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast + log_motion + Sex + log_motion:Sex, 
##     data = df_mr_contr_motion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -13.3404  -3.9433  -0.2638   3.7303  11.8853 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)          -5.134      8.400  -0.611   0.5423  
## log_contrast         -8.032      3.265  -2.460   0.0153 *
## log_motion           -7.682      3.200  -2.400   0.0179 *
## SexMale              31.289     12.420   2.519   0.0131 *
## log_motion:SexMale   12.232      5.158   2.371   0.0193 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.708 on 118 degrees of freedom
## Multiple R-squared:  0.1577, Adjusted R-squared:  0.1292 
## F-statistic: 5.524 on 4 and 118 DF,  p-value: 0.0004121</code></pre>
<pre class="r"><code>car::Anova(lm_mr_contr_motion_motion_sex_int)</code></pre>
<pre><code>## Anova Table (Type II tests)
## 
## Response: mental_rot
##                Sum Sq  Df F value  Pr(&gt;F)  
## log_contrast    197.2   1  6.0533 0.01533 *
## log_motion       49.4   1  1.5152 0.22079  
## Sex              79.5   1  2.4389 0.12104  
## log_motion:Sex  183.2   1  5.6235 0.01934 *
## Residuals      3844.7 118                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>confint(lm_mr_contr_motion_motion_sex_int)</code></pre>
<pre><code>##                         2.5 %    97.5 %
## (Intercept)        -21.769526 11.500970
## log_contrast       -14.496555 -1.567208
## log_motion         -14.018462 -1.344717
## SexMale              6.693140 55.884219
## log_motion:SexMale   2.017535 22.447308</code></pre>
<pre class="r"><code>lsr::etaSquared(lm_mr_contr_motion_motion_sex_int)</code></pre>
<pre><code>##                    eta.sq eta.sq.part
## log_contrast   0.04320822  0.04879585
## log_motion     0.01081567  0.01267812
## Sex            0.01740879  0.02025007
## log_motion:Sex 0.04014050  0.04548901</code></pre>
</div>
<div id="model-4-mental_rot-log_contrast-sex" class="section level4">
<h4>Model 4: <code>mental_rot ~ log_contrast + Sex</code></h4>
<p>Let’s try dropping <code>log_motion</code> and the <code>Sex:log_motion</code> interaction.</p>
<pre class="r"><code>lm_mr_contr_no_motion_sex &lt;- lm(mental_rot ~ log_contrast + Sex, data = df_mr_contr_motion)
summary(lm_mr_contr_no_motion_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast + Sex, data = df_mr_contr_motion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -12.5858  -3.8401  -0.3692   4.1283  13.2321 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)    10.900      5.667   1.923   0.0568 . 
## log_contrast   -8.943      3.229  -2.770   0.0065 **
## SexMale         2.416      1.253   1.928   0.0562 . 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.829 on 120 degrees of freedom
## Multiple R-squared:  0.1068, Adjusted R-squared:  0.09188 
## F-statistic: 7.171 on 2 and 120 DF,  p-value: 0.001143</code></pre>
<pre class="r"><code>car::Anova(lm_mr_contr_no_motion_sex)</code></pre>
<pre><code>## Anova Table (Type II tests)
## 
## Response: mental_rot
##              Sum Sq  Df F value   Pr(&gt;F)   
## log_contrast  260.6   1  7.6710 0.006504 **
## Sex           126.3   1  3.7167 0.056234 . 
## Residuals    4077.3 120                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>confint(lm_mr_contr_no_motion_sex)</code></pre>
<pre><code>##                    2.5 %    97.5 %
## (Intercept)   -0.3200292 22.119674
## log_contrast -15.3368186 -2.550105
## SexMale       -0.0652405  4.897012</code></pre>
<pre class="r"><code>lsr::etaSquared(lm_mr_contr_no_motion_sex)</code></pre>
<pre><code>##                  eta.sq eta.sq.part
## log_contrast 0.05710038  0.06008429
## Sex          0.02766563  0.03004185</code></pre>
<p>Compare this reduced model to the fuller one.</p>
<pre class="r"><code>anova(lm_mr_contr_motion_motion_sex_int, lm_mr_contr_no_motion_sex)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: mental_rot ~ log_contrast + log_motion + Sex + log_motion:Sex
## Model 2: mental_rot ~ log_contrast + Sex
##   Res.Df    RSS Df Sum of Sq      F  Pr(&gt;F)  
## 1    118 3844.7                              
## 2    120 4077.3 -2   -232.59 3.5694 0.03126 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>We keep the <code>log_motion</code> and <code>log_motion:Sex</code> terms in the model.</p>
</div>
<div id="model-5-mental_rot-sex" class="section level4">
<h4>Model 5: <code>mental_rot ~ Sex</code></h4>
<p>Finally, let’s drop the vision variables.</p>
<pre class="r"><code>lm_mr_no_vision_sex &lt;- lm(mental_rot ~ Sex, data = df_mr_contr_motion)
summary(lm_mr_no_vision_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ Sex, data = df_mr_contr_motion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -11.6667  -3.6667   0.3333   3.4946  13.4946 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  26.5054     0.6209  42.690   &lt;2e-16 ***
## SexMale       3.1613     1.2572   2.515   0.0132 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.988 on 121 degrees of freedom
## Multiple R-squared:  0.04966,    Adjusted R-squared:  0.04181 
## F-statistic: 6.323 on 1 and 121 DF,  p-value: 0.01323</code></pre>
<pre class="r"><code>car::Anova(lm_mr_no_vision_sex)</code></pre>
<pre><code>## Anova Table (Type II tests)
## 
## Response: mental_rot
##           Sum Sq  Df F value  Pr(&gt;F)  
## Sex        226.7   1  6.3231 0.01323 *
## Residuals 4337.9 121                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>confint(lm_mr_no_vision_sex)</code></pre>
<pre><code>##                  2.5 %    97.5 %
## (Intercept) 25.2761845 27.734568
## SexMale      0.6723665  5.650214</code></pre>
<pre class="r"><code>lsr::etaSquared(lm_mr_no_vision_sex)</code></pre>
<pre><code>##         eta.sq eta.sq.part
## Sex 0.04966209  0.04966209</code></pre>
<pre class="r"><code>anova(lm_mr_contr_motion_motion_sex_int, lm_mr_no_vision_sex)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: mental_rot ~ log_contrast + log_motion + Sex + log_motion:Sex
## Model 2: mental_rot ~ Sex
##   Res.Df    RSS Df Sum of Sq      F   Pr(&gt;F)   
## 1    118 3844.7                                
## 2    121 4337.9 -3   -493.24 5.0461 0.002521 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The fuller model with the vision variables remains the best-fitting one, even after trimming.</p>
</div>
</div>
</div>
<div id="does-interest-in-specific-male-typed-hobbies-correlate-with-vision" class="section level2">
<h2>Does interest in specific male-typed hobbies correlate with vision?</h2>
<p>Determine which hobbies are strongly male-typed according to (CITE):</p>
<ul>
<li>Golf</li>
<li>Home eletronics</li>
<li>Surfing</li>
<li>Computers</li>
<li>Video games</li>
<li>Watching violent movies</li>
<li>Going to car shows</li>
<li>Fishing</li>
<li>Poker</li>
<li>Playing Basketball</li>
<li>TV sports</li>
<li>Football</li>
<li>Weight lifting</li>
<li>Working on cars</li>
<li>Drag racing</li>
</ul>
<pre class="r"><code>var &lt;-
  c(
    &quot;Participant&quot;,
    &quot;Sex&quot;,
    &quot;log_contrast&quot;,
    &quot;log_motion&quot;,
    &quot;Golf&quot;,
    &quot;Home electronics&quot;,
    &quot;Surfing&quot;,
    &quot;Computers&quot;,
    &quot;Video games&quot;,
    &quot;Watching violent movies&quot;,
    &quot;Going to car shows&quot;,
    &quot;Fishing&quot;,
    &quot;Poker&quot;,
    &quot;Playing basketball&quot;,
    &quot;TV sports&quot;,
    &quot;Football&quot;,
    &quot;Weight lifting&quot;,
    &quot;Working on cars&quot;,
    &quot;Drag racing&quot;,
    &quot;Masculine_hobbies&quot;
  )
male_hobbies &lt;- sex_diff_df[, var]
male_hobbies_F &lt;- male_hobbies %&gt;% 
  dplyr::filter(Sex == &quot;Female&quot;)</code></pre>
<div id="calculate-alpha" class="section level3">
<h3>Calculate alpha</h3>
<pre class="r"><code>psych::alpha(male_hobbies[,-c(1:4,20)])</code></pre>
<pre><code>## 
## Reliability analysis   
## Call: psych::alpha(x = male_hobbies[, -c(1:4, 20)])
## 
##   raw_alpha std.alpha G6(smc) average_r S/N   ase mean  sd median_r
##       0.79       0.8    0.84      0.21 3.9 0.026    3 0.6      0.2
## 
##  lower alpha upper     95% confidence boundaries
## 0.74 0.79 0.85 
## 
##  Reliability if an item is dropped:
##                         raw_alpha std.alpha G6(smc) average_r S/N alpha se
## Golf                         0.79      0.79    0.84      0.22 3.9    0.027
## Home electronics             0.79      0.79    0.84      0.21 3.8    0.027
## Surfing                      0.79      0.79    0.84      0.22 3.8    0.027
## Computers                    0.79      0.79    0.83      0.21 3.8    0.027
## Video games                  0.78      0.78    0.83      0.21 3.6    0.028
## Watching violent movies      0.79      0.80    0.84      0.22 3.9    0.026
## Going to car shows           0.77      0.77    0.82      0.19 3.3    0.030
## Fishing                      0.79      0.79    0.84      0.21 3.7    0.027
## Poker                        0.79      0.79    0.84      0.21 3.7    0.027
## Playing basketball           0.77      0.78    0.83      0.20 3.5    0.029
## TV sports                    0.78      0.79    0.83      0.21 3.7    0.028
## Football                     0.78      0.78    0.83      0.21 3.6    0.028
## Weight lifting               0.79      0.79    0.84      0.21 3.8    0.027
## Working on cars              0.77      0.77    0.81      0.19 3.3    0.030
## Drag racing                  0.78      0.78    0.83      0.20 3.5    0.028
##                         var.r med.r
## Golf                    0.024  0.22
## Home electronics        0.022  0.22
## Surfing                 0.023  0.21
## Computers               0.021  0.21
## Video games             0.020  0.20
## Watching violent movies 0.022  0.21
## Going to car shows      0.021  0.18
## Fishing                 0.024  0.20
## Poker                   0.024  0.20
## Playing basketball      0.024  0.20
## TV sports               0.021  0.20
## Football                0.021  0.20
## Weight lifting          0.023  0.20
## Working on cars         0.021  0.18
## Drag racing             0.023  0.20
## 
##  Item statistics 
##                           n raw.r std.r r.cor r.drop mean   sd
## Golf                    131  0.40  0.41  0.33   0.29  2.6 1.14
## Home electronics        131  0.42  0.44  0.39   0.32  4.1 0.98
## Surfing                 131  0.41  0.41  0.34   0.30  3.0 1.15
## Computers               131  0.43  0.45  0.41   0.33  3.8 1.02
## Video games             131  0.53  0.53  0.51   0.41  3.4 1.32
## Watching violent movies 131  0.39  0.39  0.32   0.27  3.1 1.21
## Going to car shows      131  0.69  0.70  0.69   0.62  2.3 1.11
## Fishing                 131  0.47  0.47  0.40   0.36  2.9 1.14
## Poker                   131  0.49  0.49  0.43   0.38  2.9 1.18
## Playing basketball      131  0.62  0.60  0.56   0.51  3.1 1.34
## TV sports               131  0.52  0.51  0.49   0.41  3.4 1.25
## Football                131  0.55  0.53  0.51   0.44  3.6 1.23
## Weight lifting          131  0.44  0.43  0.36   0.32  3.0 1.26
## Working on cars         131  0.71  0.72  0.73   0.65  1.9 1.04
## Drag racing             131  0.57  0.57  0.54   0.47  2.3 1.15
## 
## Non missing response frequency for each item
##                            1    2    3    4    5 miss
## Golf                    0.18 0.31 0.28 0.16 0.06 0.01
## Home electronics        0.02 0.05 0.16 0.37 0.40 0.01
## Surfing                 0.15 0.13 0.44 0.18 0.11 0.01
## Computers               0.03 0.08 0.21 0.41 0.27 0.01
## Video games             0.11 0.16 0.23 0.24 0.27 0.01
## Watching violent movies 0.11 0.21 0.29 0.25 0.15 0.01
## Going to car shows      0.28 0.37 0.21 0.10 0.05 0.01
## Fishing                 0.16 0.20 0.32 0.27 0.05 0.01
## Poker                   0.17 0.20 0.32 0.24 0.08 0.01
## Playing basketball      0.17 0.18 0.26 0.21 0.18 0.01
## TV sports               0.07 0.21 0.20 0.28 0.24 0.01
## Football                0.08 0.11 0.21 0.31 0.29 0.01
## Weight lifting          0.13 0.24 0.25 0.24 0.15 0.01
## Working on cars         0.44 0.35 0.15 0.02 0.05 0.01
## Drag racing             0.30 0.27 0.29 0.08 0.05 0.01</code></pre>
</div>
<div id="check-data-for-outliers" class="section level3">
<h3>Check data for outliers</h3>
<pre class="r"><code>FindOutliers(male_hobbies$Masculine_hobbies)</code></pre>
<pre><code>## integer(0)</code></pre>
<p>No data are outliers.</p>
</div>
<div id="correlation-between-male-typed-hobbies-and-log-contrast" class="section level3">
<h3>Correlation between male-typed hobbies and log contrast</h3>
<pre class="r"><code>rcorr(as.matrix(male_hobbies_F[,-c(1,2,4)]))$P[,1] # home electronics and basketball</code></pre>
<pre><code>##            log_contrast                    Golf        Home electronics 
##                      NA             0.515670721             0.026808742 
##                 Surfing               Computers             Video games 
##             0.101246749             0.406131320             0.064211971 
## Watching violent movies      Going to car shows                 Fishing 
##             0.126427003             0.583906276             0.343230099 
##                   Poker      Playing basketball               TV sports 
##             0.625660353             0.006502565             0.451328734 
##                Football          Weight lifting         Working on cars 
##             0.655463043             0.733745030             0.338041754 
##             Drag racing       Masculine_hobbies 
##             0.446397558             0.054985103</code></pre>
<pre class="r"><code>rcorr(as.matrix(male_hobbies_F[,-c(1,2,4)]))$r[,1]</code></pre>
<pre><code>##            log_contrast                    Golf        Home electronics 
##              1.00000000              0.06609877             -0.22257196 
##                 Surfing               Computers             Video games 
##             -0.16567326             -0.08441350             -0.18673478 
## Watching violent movies      Going to car shows                 Fishing 
##             -0.15464281              0.05570944              0.09625879 
##                   Poker      Playing basketball               TV sports 
##             -0.04963025             -0.27178430             -0.07656075 
##                Football          Weight lifting         Working on cars 
##             -0.04539678             -0.03461554             -0.09729378 
##             Drag racing       Masculine_hobbies 
##             -0.07739510             -0.19349666</code></pre>
<p><code>Playing basketball</code> and <code>Home electronics</code> substantial large negative correlations (in women) with log contrast thresholds.</p>
<div id="playing-basketball-and-contrast-sensitivity" class="section level4">
<h4>Playing basketball and Contrast Sensitivity</h4>
<pre class="r"><code>cor.test(
  male_hobbies_F$log_contrast,
  male_hobbies_F$&quot;Playing basketball&quot;,
  method = &quot;pearson&quot;,
  alternative = &quot;two.sided&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  male_hobbies_F$log_contrast and male_hobbies_F$&quot;Playing basketball&quot;
## t = -2.7815, df = 97, p-value = 0.006503
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.44530403 -0.07858904
## sample estimates:
##        cor 
## -0.2717843</code></pre>
<pre class="r"><code>es_mental_mas_contrast &lt;- esci::estimateCorrelation.default(male_hobbies_F, log_contrast, &quot;Playing basketball&quot;)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>es_mental_mas_contrast$formatted_r</code></pre>
<pre><code>## [1] &quot;r = -0.27 95% CI [-0.45, -0.08]&quot;</code></pre>
</div>
<div id="home-electronics-and-contrast-sensitivity" class="section level4">
<h4>Home electronics and Contrast Sensitivity</h4>
<pre class="r"><code>cor.test(
   male_hobbies_F$log_contrast,
   male_hobbies_F$&quot;Home electronics&quot;,
  method = &quot;pearson&quot;,
  alternative = &quot;two.sided&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  male_hobbies_F$log_contrast and male_hobbies_F$&quot;Home electronics&quot;
## t = -2.2485, df = 97, p-value = 0.02681
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.40230708 -0.02631643
## sample estimates:
##       cor 
## -0.222572</code></pre>
<pre class="r"><code>es_mental_mas_contrast &lt;- esci::estimateCorrelation.default( male_hobbies_F, log_contrast, &quot;Home electronics&quot;)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>es_mental_mas_contrast$formatted_r</code></pre>
<pre><code>## [1] &quot;r = -0.22 95% CI [-0.40, -0.03]&quot;</code></pre>
</div>
</div>
<div id="correlation-between-male-typed-hobbies-and-log-motion" class="section level3">
<h3>Correlation between male-typed hobbies and log motion</h3>
<pre class="r"><code>rcorr(as.matrix(male_hobbies_F[,-c(1:3)]))$P[,1] # computer, camping, weight lifting</code></pre>
<pre><code>##              log_motion                    Golf        Home electronics 
##                      NA             0.982298677             0.490946085 
##                 Surfing               Computers             Video games 
##             0.082785357             0.016869517             0.076531451 
## Watching violent movies      Going to car shows                 Fishing 
##             0.442946624             0.959971813             0.263468621 
##                   Poker      Playing basketball               TV sports 
##             0.784023504             0.417944365             0.285775452 
##                Football          Weight lifting         Working on cars 
##             0.735051646             0.001657865             0.886451933 
##             Drag racing       Masculine_hobbies 
##             0.108169626             0.742927984</code></pre>
<pre class="r"><code>rcorr(as.matrix(male_hobbies_F[,-c(1:3)]))$r[,1]</code></pre>
<pre><code>##              log_motion                    Golf        Home electronics 
##             1.000000000             0.002282348            -0.070767181 
##                 Surfing               Computers             Video games 
##             0.177037912            -0.242137747            -0.180694692 
## Watching violent movies      Going to car shows                 Fishing 
##            -0.078800385             0.005162812            -0.114650517 
##                   Poker      Playing basketball               TV sports 
##            -0.028188456             0.083177939             0.109474652 
##                Football          Weight lifting         Working on cars 
##             0.034801421             0.315280233            -0.014688289 
##             Drag racing       Masculine_hobbies 
##             0.164132309             0.033728935</code></pre>
<p><code>Weightlifing</code> and <code>Computers</code> shows substantial correlations with motion duration thresholds.</p>
<div id="weightlifting-and-motion-duration" class="section level4">
<h4>Weightlifting and Motion Duration</h4>
<pre class="r"><code>cor.test(
   male_hobbies_F$log_motion,
   male_hobbies_F$&quot;Weight lifting&quot;,
  method = &quot;pearson&quot;,
  alternative = &quot;two.sided&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  male_hobbies_F$log_motion and male_hobbies_F$&quot;Weight lifting&quot;
## t = 3.2381, df = 95, p-value = 0.001658
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.1236075 0.4842739
## sample estimates:
##       cor 
## 0.3152802</code></pre>
<pre class="r"><code>es_mental_mas_contrast &lt;- esci::estimateCorrelation.default( male_hobbies_F, log_motion, &quot;Weight lifting&quot;)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>es_mental_mas_contrast$formatted_r</code></pre>
<pre><code>## [1] &quot;r = 0.32 95% CI [0.12, 0.48]&quot;</code></pre>
<div id="computers-and-motion-duration" class="section level5">
<h5>Computers and Motion Duration</h5>
<pre class="r"><code>cor.test(
   male_hobbies_F$log_motion,
   male_hobbies_F$&quot;Computers&quot;,
  method = &quot;pearson&quot;,
  alternative = &quot;two.sided&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  male_hobbies_F$log_motion and male_hobbies_F$Computers
## t = -2.4325, df = 95, p-value = 0.01687
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.42124004 -0.04485878
## sample estimates:
##        cor 
## -0.2421377</code></pre>
<pre class="r"><code>es_mental_mas_contrast &lt;- esci::estimateCorrelation.default( male_hobbies_F, log_motion, &quot;Computers&quot;)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>es_mental_mas_contrast$formatted_r</code></pre>
<pre><code>## [1] &quot;r = -0.24 95% CI [-0.42, -0.04]&quot;</code></pre>
</div>
</div>
</div>
<div id="set-function-for-scatterplot" class="section level3">
<h3>set function for scatterplot</h3>
<pre class="r"><code>sex_diff_scatter3 &lt;-
  function(df,
           x_var,
           y_var,
           x_lab = &quot;X axis&quot;,
           y_lab = &quot;Y axis&quot;
           ) {
    require(tidyverse)
    require(ggExtra)
    
    x_var_s &lt;- sym(x_var)
    y_var_s &lt;- sym(y_var)
    
    p &lt;- ggplot(df) +
      aes(
        x = !!x_var_s,
        y = !!y_var_s
      ) +
      geom_point(size=4) +
      xlab(x_var) +
      ylab(y_var) +
      stat_smooth(method = &quot;lm&quot;, na.rm = TRUE) +
      xlab(x_lab) +
      ylab(y_lab)+
      theme.custom +
      ylim(1, 5) 
p
  }</code></pre>
<div id="get-scatterplot-for-contrast-sensitivity-and-playing-basketball" class="section level4">
<h4>get scatterplot for contrast sensitivity and playing basketball</h4>
<pre class="r"><code>sex_diff_scatter3(
  male_hobbies_F,
  &quot;log_contrast&quot;,
  &quot;Playing basketball&quot;,
  &quot;log(contrast threshold)&quot;,
  &quot;Playing basketball&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 3 rows containing missing values (geom_point).</code></pre>
<p><img src="img/unnamed-chunk-94-1.png" width="2100" style="display: block; margin: auto;" /> #### get scatterplot for contrast sensitivity and electronics</p>
<pre class="r"><code>sex_diff_scatter3(
  male_hobbies_F,
  &quot;log_contrast&quot;,
  &quot;Home electronics&quot;,
  &quot;log(contrast threshold)&quot;,
  &quot;Home electronics&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 3 rows containing missing values (geom_point).</code></pre>
<p><img src="img/unnamed-chunk-95-1.png" width="2100" style="display: block; margin: auto;" /> #### get scatterplot for motion sensitivity and weight lifting</p>
<pre class="r"><code>sex_diff_scatter3(
  male_hobbies_F,
  &quot;log_motion&quot;,
  &quot;Weight lifting&quot;,
  &quot;log(motion threshold)&quot;,
  &quot;Weight lifting&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 5 rows containing missing values (geom_point).</code></pre>
<p><img src="img/unnamed-chunk-96-1.png" width="2100" style="display: block; margin: auto;" /> #### get scatterplot for motion sensitivity and weight lifting, after excluding outliers</p>
<pre class="r"><code>male_hobbies_Fex&lt;-male_hobbies_F[-which(male_hobbies_F$log_motion &gt; -1),]
sex_diff_scatter3(
  male_hobbies_Fex,
  &quot;log_motion&quot;,
  &quot;Weight lifting&quot;,
  &quot;log(motion threshold)&quot;,
  &quot;Weight lifting&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 5 rows containing missing values (geom_point).</code></pre>
<p><img src="img/unnamed-chunk-97-1.png" width="2100" style="display: block; margin: auto;" /></p>
</div>
<div id="get-scatterplot-for-motion-sensitivity-and-weight-lifting" class="section level4">
<h4>get scatterplot for motion sensitivity and weight lifting</h4>
<pre class="r"><code>sex_diff_scatter3(
  male_hobbies_F,
  &quot;log_motion&quot;,
  &quot;Computers&quot;,
  &quot;log(motion threshold)&quot;,
  &quot;Computers&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 5 rows containing missing values (geom_point).</code></pre>
<p><img src="img/unnamed-chunk-98-1.png" width="2100" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="do-men-and-women-differ-in-other-ways" class="section level2">
<h2>Do men and women differ in other ways?</h2>
<div id="age" class="section level3">
<h3>Age</h3>
<pre class="r"><code>xtabs(~ Sex + Age, df_trimmed)</code></pre>
<pre><code>##         Age
## Sex      18-19 20-21 22-23 23+
##   Female    74    21     2   2
##   Male      19     9     1   1</code></pre>
</div>
<div id="school_year" class="section level3">
<h3>School_year</h3>
<pre class="r"><code>xtabs(~ Sex + School_year, df_trimmed)</code></pre>
<pre><code>##         School_year
## Sex      1st 2nd 3rd 4th
##   Female  64  19  12   4
##   Male    19   3   6   2</code></pre>
</div>
<div id="visual-acuity" class="section level3">
<h3>Visual acuity</h3>
<pre class="r"><code>xtabs(~ Sex + Acuity, df_trimmed)</code></pre>
<pre><code>##         Acuity
## Sex      20/16 20/20 20/25 20/32
##   Female    77    20     1     1
##   Male      19    10     1     0</code></pre>
</div>
<div id="stereo-acuity" class="section level3">
<h3>Stereo acuity</h3>
<pre class="r"><code>xtabs(~ Sex + Stereo_amin, df_trimmed)</code></pre>
<pre><code>##         Stereo_amin
## Sex      40 50 60 80 100 140 400 800
##   Female 84  5  3  2   2   2   0   1
##   Male   21  0  3  1   2   1   2   0</code></pre>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
