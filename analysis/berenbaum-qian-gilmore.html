<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Yiming Qian &amp; Rick Gilmore" />


<title>Analyses for Berenbaum, Qian, &amp; Gilmore</title>

<script src="berenbaum-qian-gilmore_files/header-attrs-2.9/header-attrs.js"></script>
<script src="berenbaum-qian-gilmore_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="berenbaum-qian-gilmore_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="berenbaum-qian-gilmore_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="berenbaum-qian-gilmore_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="berenbaum-qian-gilmore_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="berenbaum-qian-gilmore_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="berenbaum-qian-gilmore_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="berenbaum-qian-gilmore_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="berenbaum-qian-gilmore_files/navigation-1.1/tabsets.js"></script>
<script src="berenbaum-qian-gilmore_files/navigation-1.1/codefolding.js"></script>
<link href="berenbaum-qian-gilmore_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="berenbaum-qian-gilmore_files/highlightjs-9.12.0/highlight.js"></script>
<script src="berenbaum-qian-gilmore_files/kePrint-0.0.1/kePrint.js"></script>
<link href="berenbaum-qian-gilmore_files/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Analyses for Berenbaum, Qian, &amp; Gilmore</h1>
<h4 class="author">Yiming Qian &amp; Rick Gilmore</h4>
<h4 class="date">2021-08-04 09:31:06</h4>

</div>


<div id="purpose" class="section level1">
<h1>Purpose</h1>
<p>This document shows our analyses following a plan we preregistered here:</p>
<p><a href="https://aspredicted.org/5iv9a.pdf" class="uri">https://aspredicted.org/5iv9a.pdf</a></p>
<p>It also shows a series of analyses that were not preregistered.</p>
</div>
<div id="setup" class="section level1">
<h1>Setup</h1>
<p>Set chunk options and load libraries.</p>
</div>
<div id="import-data" class="section level1">
<h1>Import data</h1>
<p>Data from the set of tasks were merged and cleaned as described in <code>import-clean-raw-data.Rmd</code>.</p>
<pre class="r"><code>sex_diff_df &lt;- readr::read_csv(file.path(params$data_path, params$csv_fn)) </code></pre>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   .default = col_double(),
##   Sex = col_character(),
##   Race = col_character(),
##   Major = col_character(),
##   Color_vision = col_logical()
## )
## ℹ Use `spec()` for the full column specifications.</code></pre>
</div>
<div id="preregistered-analyses" class="section level1">
<h1>Preregistered analyses</h1>
<div id="individual-measures" class="section level2">
<h2>Individual measures</h2>
<div id="visual-perception-thresholds" class="section level3">
<h3>Visual perception thresholds</h3>
<blockquote>
<p>An average threshold for each participant will be calculated across 4 runs for each visual perception task. If necessary, we will transform the psychophysical thresholds to make the distributions symmetric and appropriate for parametric analyses.</p>
</blockquote>
<p>In the analyses below, we use the median threshold across the four runs.</p>
<p>The distribution of median thresholds is skewed, as indicated in the figures below:</p>
<pre class="r"><code>sex_diff_df %&gt;%
  ggplot(.) +
  aes(x = contrast_thr) +
  geom_histogram()</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 2 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="img/contrast-hist-1.png" width="2100" style="display: block; margin: auto;" /></p>
<pre class="r"><code>sex_diff_df %&gt;%
  ggplot(.) +
  aes(x = motion_dur_thr) +
  geom_histogram()</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="img/motion-hist-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>So, we use a log transformation.</p>
<pre class="r"><code>sex_diff_df &lt;- sex_diff_df %&gt;%
  dplyr::mutate(.,
                log_contrast = log(contrast_thr),
                log_motion = log(motion_dur_thr))</code></pre>
<blockquote>
<p>To examine sex differences, one-tailed t tests will be conducted to compare men and women on 2 visual perception thresholds, spatial ability, and masculine hobbies. We will use verbal ability as our control variable. We set a family-wise Type I error rate at alpha=0.05. Because there are four dependent variables hypothesized to show sex differences, the critical p value for each sex comparison is 0.0125 after Bonferroni correction. Our goal is to obtain .8 power to detect a medium effect size of .5 (Cohen’s d) at the p value of .0125 in the one-tailed t tests. Unequal sample sizes of the two sexes may be collected in this study.</p>
</blockquote>
<div id="contrast-thresholds" class="section level4">
<h4>Contrast thresholds</h4>
<pre class="r"><code>df_contrast &lt;- sex_diff_df %&gt;%
  dplyr::filter(., !is.na(log_contrast)) %&gt;%
  dplyr::select(., Sex, log_contrast)
xtabs(~ Sex, df_contrast)</code></pre>
<pre><code>## Sex
## Females   Males 
##     100      30</code></pre>
<pre class="r"><code>sex_diff_df %&gt;%
  ggplot() +
  aes(Sex, log_contrast) +
  geom_boxplot()</code></pre>
<pre><code>## Warning: Removed 2 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="img/unnamed-chunk-3-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>We then test for a difference in means.</p>
<pre class="r"><code>cst_tt &lt;-
  t.test(
    log_contrast ~ Sex,
    data = sex_diff_df,
    var.equal = TRUE,
    alternative = &quot;greater&quot;
  ) # Hypothesized
cst_tt</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  log_contrast by Sex
## t = 2.4867, df = 128, p-value = 0.00709
## alternative hypothesis: true difference in means between group Females and group Males is greater than 0
## 95 percent confidence interval:
##  0.02900351        Inf
## sample estimates:
## mean in group Females   mean in group Males 
##             -1.741348             -1.828258</code></pre>
<p>Median log(contrast) thresholds are lower in women than men This means that women had larger contrast thresholds or were less sensitive to contrast.</p>
<p>This can be seen in a plot in the original threshold units.</p>
<pre class="r"><code>sex_diff_df %&gt;%
  ggplot() +
  aes(Sex, contrast_thr) +
  geom_boxplot()</code></pre>
<pre><code>## Warning: Removed 2 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="img/unnamed-chunk-5-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>We use the <code>esvis</code> package to compute the Hedge’s G effect size measure since the groups have unequal means.</p>
<pre class="r"><code>esvis::hedg_g(sex_diff_df, log_contrast ~ Sex)</code></pre>
<pre><code>## # A tibble: 2 x 4
##   Sex_ref Sex_foc  coh_d hedg_g
##   &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;
## 1 Females Males    0.518  0.515
## 2 Males   Females -0.518 -0.515</code></pre>
<p>In order to compute a confidence interval for the effect size, we use the <code>esci</code> package. We have already installed the package, so we set the following chunk to <code>eval=FALSE</code>.</p>
<pre class="r"><code>devtools::install_github(&quot;rcalinjageman/esci&quot;)</code></pre>
<pre class="r"><code>sex_diff_df$Sex.factor &lt;- as.factor(sex_diff_df$Sex)

es_log_contrast &lt;- esci::estimateMeanDifference.default(sex_diff_df,
                                     Sex.factor,
                                     log_contrast,
                                     paired = FALSE,
                                     var.equal = TRUE,
                                     conf.level = .95)
#es_log_contrast</code></pre>
<p>d_unbiased = 0.51 95% CI [0.11, 0.94]</p>
</div>
<div id="motion-duration-thresholds" class="section level4">
<h4>Motion duration thresholds</h4>
<pre class="r"><code>df_motion &lt;- sex_diff_df %&gt;%
  dplyr::filter(., !is.na(log_motion)) %&gt;%
  dplyr::select(., Sex, log_motion)
xtabs(~ Sex, df_motion)</code></pre>
<pre><code>## Sex
## Females   Males 
##      98      30</code></pre>
<pre class="r"><code>sex_diff_df %&gt;%
  ggplot() +
  aes(Sex, log_motion) +
  geom_boxplot()</code></pre>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="img/unnamed-chunk-9-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>We then test for a difference in means.</p>
<pre class="r"><code>mdt_tt &lt;-
  t.test(
    log_motion ~ Sex,
    data = sex_diff_df,
    var.equal = TRUE,
    alternative = &quot;greater&quot;
  ) # Hypothesized
mdt_tt</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  log_motion by Sex
## t = 3.509, df = 126, p-value = 0.0003122
## alternative hypothesis: true difference in means between group Females and group Males is greater than 0
## 95 percent confidence interval:
##  0.09735106        Inf
## sample estimates:
## mean in group Females   mean in group Males 
##             -2.270497             -2.454955</code></pre>
<p>Median log(motion duration) thresholds are larger in women than men This means that women were less sensitive to motion.</p>
<p>This can be seen in a plot in the original threshold units.</p>
<pre class="r"><code>sex_diff_df %&gt;%
  ggplot() +
  aes(Sex, motion_dur_thr) +
  geom_boxplot()</code></pre>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="img/unnamed-chunk-11-1.png" width="2100" style="display: block; margin: auto;" /></p>
<pre class="r"><code>esvis::hedg_g(sex_diff_df, log_motion ~ Sex)</code></pre>
<pre><code>## # A tibble: 2 x 4
##   Sex_ref Sex_foc  coh_d hedg_g
##   &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;
## 1 Females Males    0.732  0.728
## 2 Males   Females -0.732 -0.728</code></pre>
<p>Using <code>esci</code> to calculate a CI:</p>
<pre class="r"><code>es_log_motion &lt;- esci::estimateMeanDifference.default(sex_diff_df,
                                     Sex.factor,
                                     log_motion,
                                     paired = FALSE,
                                     var.equal = TRUE,
                                     conf.level = .95)
#es_log_motion</code></pre>
<p>d_unbiased = 0.73 95% CI [0.32, 1.16]</p>
</div>
</div>
<div id="spatial-ability" class="section level3">
<h3>Spatial ability</h3>
<p>Our measure of spatial ability is performance on a mental rotation task.</p>
<pre class="r"><code>df_mental_rot &lt;- sex_diff_df %&gt;%
  dplyr::filter(., !is.na(mental_rot)) %&gt;%
  dplyr::select(., Sex, mental_rot)
xtabs(~ Sex, df_mental_rot)</code></pre>
<pre><code>## Sex
## Females   Males 
##     101      30</code></pre>
<pre class="r"><code>sex_diff_df %&gt;%
  ggplot() +
  aes(Sex, mental_rot) +
  geom_boxplot()</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="img/unnamed-chunk-14-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>We test for a difference in means.</p>
<pre class="r"><code>mr_tt &lt;-
  t.test(
    mental_rot ~ Sex,
    data = sex_diff_df,
    var.equal = TRUE,
    alternative = &quot;less&quot;
  ) # Hypothesized
mr_tt</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  mental_rot by Sex
## t = -2.7478, df = 129, p-value = 0.003429
## alternative hypothesis: true difference in means between group Females and group Males is less than 0
## 95 percent confidence interval:
##       -Inf -1.373374
## sample estimates:
## mean in group Females   mean in group Males 
##              26.20792              29.66667</code></pre>
<p>Women had fewer correct trials than men. This is shown by the effect size.</p>
<pre class="r"><code>esvis::hedg_g(sex_diff_df, mental_rot ~ Sex)</code></pre>
<pre><code>## # A tibble: 2 x 4
##   Sex_ref Sex_foc  coh_d hedg_g
##   &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;
## 1 Females Males   -0.571 -0.568
## 2 Males   Females  0.571  0.568</code></pre>
<p>Using <code>esci</code> to calculate CIs.</p>
<pre class="r"><code>es_mental_rot &lt;- esci::estimateMeanDifference.default(sex_diff_df,
                                     Sex.factor,
                                     mental_rot,
                                     paired = FALSE,
                                     var.equal = TRUE,
                                     conf.level = .95)
#es_mental_rot</code></pre>
<p>d_unbiased = -0.57 95% CI [-1.00, -0.16].</p>
</div>
<div id="male-typed-hobbies" class="section level3">
<h3>Male-typed hobbies</h3>
<pre class="r"><code>df_m_hobbies &lt;- sex_diff_df %&gt;%
  dplyr::filter(., !is.na(Masculine_hobbies)) %&gt;%
  dplyr::select(., Sex, Masculine_hobbies)
xtabs(~ Sex, df_m_hobbies)</code></pre>
<pre><code>## Sex
## Females   Males 
##     101      30</code></pre>
<pre class="r"><code>sex_diff_df %&gt;%
  ggplot() +
  aes(Sex, Masculine_hobbies) +
  geom_boxplot()</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="img/unnamed-chunk-18-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>We test for a difference in means.</p>
<pre class="r"><code>mr_tt &lt;-
  t.test(
    Masculine_hobbies ~ Sex,
    data = sex_diff_df,
    var.equal = TRUE,
    alternative = &quot;less&quot;
  ) # Hypothesized
mr_tt</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  Masculine_hobbies by Sex
## t = -7.422, df = 129, p-value = 6.896e-12
## alternative hypothesis: true difference in means between group Females and group Males is less than 0
## 95 percent confidence interval:
##        -Inf -0.5307975
## sample estimates:
## mean in group Females   mean in group Males 
##              2.797619              3.480952</code></pre>
<pre class="r"><code>esvis::hedg_g(sex_diff_df, Masculine_hobbies ~ Sex)</code></pre>
<pre><code>## # A tibble: 2 x 4
##   Sex_ref Sex_foc coh_d hedg_g
##   &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;
## 1 Females Males   -1.54  -1.53
## 2 Males   Females  1.54   1.53</code></pre>
<p>Using <code>esci</code> to calculate CIs.</p>
<pre class="r"><code>es_m_hobbies &lt;- esci::estimateMeanDifference.default(sex_diff_df,
                                     Sex.factor,
                                     Masculine_hobbies,
                                     paired = FALSE,
                                     var.equal = TRUE,
                                     conf.level = .95)
#es_m_hobbies</code></pre>
<p>d_unbiased = -1.53 95% CI [-2.01, -1.11].</p>
</div>
<div id="verbal-ability" class="section level3">
<h3>Verbal ability</h3>
<p>We predicted no sex difference in verbal ability as measured by vocabulary size.</p>
<pre class="r"><code>sex_diff_df %&gt;%
  ggplot() +
  aes(Sex, Masculine_hobbies) +
  geom_boxplot()</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="img/unnamed-chunk-21-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>We test for a difference in means.</p>
<pre class="r"><code>vocab_tt &lt;-
  t.test(
    vocab ~ Sex,
    data = sex_diff_df,
    var.equal = TRUE,
    alternative = &quot;two.sided&quot;
  ) # Hypothesized
vocab_tt</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  vocab by Sex
## t = -0.74845, df = 129, p-value = 0.4556
## alternative hypothesis: true difference in means between group Females and group Males is not equal to 0
## 95 percent confidence interval:
##  -2.735626  1.233976
## sample estimates:
## mean in group Females   mean in group Males 
##              9.165842              9.916667</code></pre>
<p>We find no statistically significant difference in vocabulary scores.</p>
<p>This is also shown by the effect size.</p>
<pre class="r"><code>esvis::hedg_g(sex_diff_df, vocab ~ Sex)</code></pre>
<pre><code>## # A tibble: 2 x 4
##   Sex_ref Sex_foc  coh_d hedg_g
##   &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;
## 1 Females Males   -0.156 -0.155
## 2 Males   Females  0.156  0.155</code></pre>
<pre class="r"><code>es_vocab &lt;- esci::estimateMeanDifference.default(sex_diff_df,
                                     Sex.factor,
                                     vocab,
                                     paired = FALSE,
                                     var.equal = TRUE,
                                     conf.level = .95)
#es_vocab</code></pre>
<p>d_unbiased = -1.53 95% CI [-2.01, -1.11].</p>
</div>
</div>
<div id="correlations-among-measures" class="section level2">
<h2>Correlations among measures</h2>
<blockquote>
<p>To examine how individual differences of visual perception measures are associated with other tasks, we will use correlations within sex. The lower visual perception threshold is, the higher perceptual sensitivity this individual has. In both sexes, we expect to find negative correlations between visual perception measures and spatial ability and masculine hobbies, but no significant correlation with verbal ability. There are four planned correlations (two visual perception tasks times two cognitive tasks) within sex, for a total of eight. This project is a novel study that has not to our knowledge been conducted previously. So we have consciously decided to maintain strict control of Type II error, in order to have enough statistical power to detect a small correlation effect sizes (r=0.20) within the constraints of sample size. This decision to maximize the power (.80) leads to a trade-off between Type I and Type II error. We plan to conduct eight separate one-tailed correlation tests with Type I error at 0.05 and no Bonferroni correction. With a critical p value of .05, around 150 participants are required for each group to detect an effect size of 0.20 at an obtained power of 0.8 with a one-tailed correlation test.</p>
</blockquote>
<p>We create two data frames by participant sex.</p>
<pre class="r"><code>sex_diff_df_F &lt;- sex_diff_df %&gt;%
  dplyr::filter(., Sex == &quot;Females&quot;)</code></pre>
<pre class="r"><code>sex_diff_df_M &lt;- sex_diff_df %&gt;%
  dplyr::filter(., Sex == &quot;Males&quot;)</code></pre>
<div id="contrast-thresholds-and-mental-rotation" class="section level3">
<h3>Contrast thresholds and mental rotation</h3>
<div id="women" class="section level4">
<h4>Women</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_F$log_contrast,
  sex_diff_df_F$mental_rot,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_F$log_contrast and sex_diff_df_F$mental_rot
## t = -2.9154, df = 97, p-value = 0.002206
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.0000000 -0.1233413
## sample estimates:
##        cor 
## -0.2838364</code></pre>
<p>Contrast thresholds (negatively) correlate with mental rotation scores in women The negative correlation means that smaller log(contrast) values or higher contrast sensitivity is associated with better performance in the mental rotation task.</p>
<p>We can use <code>esci</code> to provide CIs for this estimate.</p>
<pre class="r"><code>es_mental_rot_contrast &lt;- esci::estimateCorrelation.default(sex_diff_df_F, log_contrast, mental_rot)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_mental_rot_contrast</code></pre>
<p>We estimate the correlation between mental_rotation and log contrast thresholds in women as follows: r = -0.28 95% CI [-0.46, -0.09].</p>
</div>
<div id="men" class="section level4">
<h4>Men</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_M$log_contrast,
  sex_diff_df_M$mental_rot,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_M$log_contrast and sex_diff_df_M$mental_rot
## t = -1.334, df = 28, p-value = 0.09647
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.00000000  0.06694135
## sample estimates:
##        cor 
## -0.2444586</code></pre>
<p>Contrast thresholds do not significantly correlate with mental rotation scores in men.</p>
<p>We can use <code>esci</code> to provide CIs for this estimate.</p>
<pre class="r"><code>es_mental_rot_contrast &lt;- esci::estimateCorrelation.default(sex_diff_df_M, log_contrast, mental_rot)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_mental_rot_contrast</code></pre>
<p>We estimate the correlation between mental_rotation and log contrast thresholds in men as follows: r = -0.24 95% CI [-0.56, 0.13].</p>
</div>
</div>
<div id="motion-thresholds-and-mental-rotation" class="section level3">
<h3>Motion thresholds and mental rotation</h3>
<div id="women-1" class="section level4">
<h4>Women</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_F$log_motion,
  sex_diff_df_F$mental_rot,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_F$log_motion and sex_diff_df_F$mental_rot
## t = -3.2535, df = 95, p-value = 0.0007897
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.0000000 -0.1569305
## sample estimates:
##        cor 
## -0.3166253</code></pre>
<p>Log(motion duration) thresholds (negatively) correlate with mental rotation scores in women This means that lower thresholds (higher sensitivity) is associated with better performance in the mental rotation task.</p>
<p>We can use <code>esci</code> to provide CIs for this estimate.</p>
<pre class="r"><code>es_mental_rot_motion &lt;- esci::estimateCorrelation.default(sex_diff_df_F, log_motion, mental_rot)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_mental_rot_motion</code></pre>
<p>We estimate the correlation between mental_rotateion and log motion thresholds in women as follows: r = -0.32 95% CI [-0.49, -0.13].</p>
</div>
<div id="men-1" class="section level4">
<h4>Men</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_M$log_motion,
  sex_diff_df_M$mental_rot,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_M$log_motion and sex_diff_df_M$mental_rot
## t = 0.64141, df = 28, p-value = 0.7368
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.0000000  0.4115473
## sample estimates:
##       cor 
## 0.1203345</code></pre>
<p>Motion duration thresholds do not significantly correlate with mental rotation scores in men.</p>
<p>We can use <code>esci</code> to provide CIs for this estimate.</p>
<pre class="r"><code>es_mental_rot_motion &lt;- esci::estimateCorrelation.default(sex_diff_df_M, log_motion, mental_rot)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_mental_rot_motion</code></pre>
<p>We estimate the correlation between mental_rotation and log motion thresholds in men as follows: r = 0.12 95% CI [-0.25, 0.46]</p>
</div>
</div>
<div id="contrast-thresholds-and-male-typed-activities" class="section level3">
<h3>Contrast thresholds and male-typed activities</h3>
<div id="women-2" class="section level4">
<h4>Women</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_F$Masculine_hobbies,
  sex_diff_df_F$log_contrast,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_F$Masculine_hobbies and sex_diff_df_F$log_contrast
## t = -1.991, df = 97, p-value = 0.02464
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.00000000 -0.03291784
## sample estimates:
##        cor 
## -0.1981507</code></pre>
<pre class="r"><code>es_contrast_m_hobbies &lt;- esci::estimateCorrelation.default(sex_diff_df_F, Masculine_hobbies, log_contrast)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_mental_rot_motion</code></pre>
<p>We estimate the correlation between log contrast and interest in male-typed activities in women as follows: r = -0.20 95% CI [-0.38, -0.00]</p>
</div>
<div id="men-2" class="section level4">
<h4>Men</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_M$Masculine_hobbies,
  sex_diff_df_M$log_contrast,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_M$Masculine_hobbies and sex_diff_df_M$log_contrast
## t = 0.79998, df = 28, p-value = 0.7848
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.0000000  0.4359053
## sample estimates:
##       cor 
## 0.1494835</code></pre>
<pre class="r"><code>es_contrast_m_hobbies &lt;- esci::estimateCorrelation.default(sex_diff_df_M, Masculine_hobbies, log_contrast)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_mental_rot_motion</code></pre>
<p>We estimate the correlation between mental_rotation and interest in male-typed activities in men as follows: r = 0.15 95% CI [-0.22, 0.48]</p>
</div>
</div>
<div id="motion-thresholds-and-male-typed-activities" class="section level3">
<h3>Motion thresholds and male-typed activities</h3>
<div id="women-3" class="section level4">
<h4>Women</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_F$Masculine_hobbies,
  sex_diff_df_F$log_motion,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_F$Masculine_hobbies and sex_diff_df_F$log_motion
## t = 0.23468, df = 95, p-value = 0.5925
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.0000000  0.1913417
## sample estimates:
##        cor 
## 0.02407113</code></pre>
<pre class="r"><code>es_motion_m_hobbies &lt;- esci::estimateCorrelation.default(sex_diff_df_F, Masculine_hobbies, log_motion)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_mental_rot_motion</code></pre>
<p>We estimate the correlation between log motion and interest in male-typed activities in women as follows: r = 0.02 95% CI [-0.18, 0.22]</p>
</div>
<div id="men-3" class="section level4">
<h4>Men</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_M$Masculine_hobbies,
  sex_diff_df_M$log_motion,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_M$Masculine_hobbies and sex_diff_df_M$log_motion
## t = 0.82792, df = 28, p-value = 0.7926
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.0000000  0.4401232
## sample estimates:
##       cor 
## 0.1545821</code></pre>
<pre class="r"><code>es_motion_m_hobbies &lt;- esci::estimateCorrelation.default(sex_diff_df_M, Masculine_hobbies, log_motion)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_mental_rot_motion</code></pre>
<p>We estimate the correlation between mental_rotation and interest in male-typed activities in men as follows: r = 0.15 95% CI [-0.22, 0.49]</p>
</div>
</div>
<div id="contrast-thresholds-and-motion-thresholds" class="section level3">
<h3>Contrast thresholds and motion thresholds</h3>
<div id="women-4" class="section level4">
<h4>Women</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_F$log_contrast,
  sex_diff_df_F$log_motion,
  method = &quot;pearson&quot;,
  alternative = &quot;greater&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_F$log_contrast and sex_diff_df_F$log_motion
## t = 1.4268, df = 94, p-value = 0.07848
## alternative hypothesis: true correlation is greater than 0
## 95 percent confidence interval:
##  -0.02392513  1.00000000
## sample estimates:
##       cor 
## 0.1455917</code></pre>
<p>The vision measures do not correlate in women.</p>
<p>We can use <code>esci</code> to provide CIs for this estimate.</p>
<pre class="r"><code>es_contrast_motion &lt;- esci::estimateCorrelation.default(sex_diff_df_F, log_contrast, log_motion)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_contrast_motion</code></pre>
<p>We estimate the correlation between log contrast and log motion thresholds in women as follows: r = 0.15 95% CI [-0.06, 0.34].</p>
</div>
<div id="men-4" class="section level4">
<h4>Men</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_M$log_contrast,
  sex_diff_df_M$log_motion,
  method = &quot;pearson&quot;,
  alternative = &quot;greater&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_M$log_contrast and sex_diff_df_M$log_motion
## t = 2.3575, df = 28, p-value = 0.01281
## alternative hypothesis: true correlation is greater than 0
## 95 percent confidence interval:
##  0.1149104 1.0000000
## sample estimates:
##       cor 
## 0.4069684</code></pre>
<p>The vision measures correlate in men.</p>
<p>We can use <code>esci</code> to provide CIs for this estimate.</p>
<pre class="r"><code>es_contrast_motion &lt;- esci::estimateCorrelation.default(sex_diff_df_M, log_contrast, log_motion)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_contrast_motion</code></pre>
<p>We estimate the correlation between log contrast and log motion thresholds in men as follows: r = 0.41 95% CI [0.05, 0.67].</p>
</div>
</div>
<div id="male-typed-activities-and-mental-rotation" class="section level3">
<h3>Male-typed activities and mental rotation</h3>
<p>We did not preregister this analysis.</p>
<div id="women-5" class="section level4">
<h4>Women</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_F$Masculine_hobbies,
  sex_diff_df_F$mental_rot,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_F$Masculine_hobbies and sex_diff_df_F$mental_rot
## t = -0.68096, df = 99, p-value = 0.2487
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.00000000  0.09745922
## sample estimates:
##         cor 
## -0.06827935</code></pre>
<pre class="r"><code>es_mental_rot_m_hobbies &lt;- esci::estimateCorrelation.default(sex_diff_df_F, Masculine_hobbies, mental_rot)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_mental_rot_motion</code></pre>
<p>We estimate the correlation between mental rotation and interest in male-typed activities in women as follows: r = -0.07 95% CI [-0.26, 0.13]</p>
</div>
<div id="men-5" class="section level4">
<h4>Men</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_M$Masculine_hobbies,
  sex_diff_df_M$mental_rot,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_M$Masculine_hobbies and sex_diff_df_M$mental_rot
## t = -0.19244, df = 28, p-value = 0.4244
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.0000000  0.2730825
## sample estimates:
##         cor 
## -0.03634446</code></pre>
<pre class="r"><code>es_mental_rot_m_hobbies &lt;- esci::estimateCorrelation.default(sex_diff_df_M, Masculine_hobbies, mental_rot)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_mental_rot_motion</code></pre>
<p>We estimate the correlation between mental_rotation and interest in male-typed activities in women as follows: r = -0.04 95% CI [-0.39, 0.33]</p>
</div>
</div>
</div>
<div id="visualizations" class="section level2">
<h2>Visualizations</h2>
<p>The following scatterplots are formatted so that higher sensitivity on the visual tasks (lower log thresholds) are to the right.</p>
<pre class="r"><code>sex_diff_scatter &lt;-
  function(df,
           x_var,
           y_var,
           x_rev = FALSE,
           y_rev = FALSE,
           an_f = &quot;&quot;,
           an_m = &quot;&quot;,
           anx = NULL,
           any = NULL,
           x_lab = &quot;X axis&quot;,
           y_lab = &quot;Y axis&quot;,
           square_axis = TRUE,
           margin_type = &quot;boxplot&quot;,
           show_corr_vals = FALSE) {
    require(tidyverse)
    require(ggExtra)
    
    x_var_s &lt;- sym(x_var)
    y_var_s &lt;- sym(y_var)
    
    p &lt;- ggplot(df) +
      aes(
        x = !!x_var_s,
        y = !!y_var_s,
        group = Sex,
        color = Sex
      ) +
      geom_point() +
      xlab(x_var) +
      ylab(y_var) +
      stat_smooth(method = &quot;lm&quot;, na.rm = TRUE) +
      theme_classic2() +
      theme(legend.position = &quot;bottom&quot;,
            legend.title = element_blank()) +
      xlab(x_lab) +
      ylab(y_lab)

    if (show_corr_vals) {
      p + annotate(
        &quot;text&quot;,
        x = anx,
        y = any,
        label = c(an_f, an_m),
        color = c(&#39;red&#39;, &#39;darkturquoise&#39;)
      )
    }
    
    if (square_axis)
    {
      p + coord_fixed() + theme(asp.ratio = 1)
    }
    
    if (stringr::str_detect(x_var, &#39;hobbies&#39;)) {
      p &lt;- p + xlim(1, 5)
    }
    if (stringr::str_detect(y_var, &#39;hobbies&#39;)) {
      p &lt;- p + ylim(1, 5)
    }
    
    # Reverse scale for threshold measures?
    if (x_rev)
      p &lt;- p + scale_x_reverse()
    if (y_rev)
      p &lt;- p + scale_y_reverse()
    
    p1 &lt;- ggExtra::ggMarginal(p,
                              type = margin_type,
                              margins = &quot;both&quot;,
                              groupFill = TRUE)
    p1
  }</code></pre>
<p>Create matrices of correlation coefficients for subsequent plotting.</p>
<pre class="r"><code>corr_vars &lt;- c(&#39;log_contrast&#39;, &#39;log_motion&#39;, &#39;mental_rot&#39;, &#39;Masculine_hobbies&#39;)
df_corr_F &lt;- sex_diff_df_F %&gt;%
  dplyr::select(., corr_vars)</code></pre>
<pre><code>## Note: Using an external vector in selections is ambiguous.
## ℹ Use `all_of(corr_vars)` instead of `corr_vars` to silence this message.
## ℹ See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.
## This message is displayed once per session.</code></pre>
<pre class="r"><code>corr_F &lt;- Hmisc::rcorr(as.matrix(df_corr_F), type = c(&quot;pearson&quot;))

df_corr_M &lt;- sex_diff_df_M %&gt;%
  dplyr::select(., corr_vars)

corr_M &lt;- Hmisc::rcorr(as.matrix(df_corr_M), type = c(&quot;pearson&quot;))

df_corr_all &lt;- sex_diff_df %&gt;%
  dplyr::select(., corr_vars)

corr_all &lt;- Hmisc::rcorr(as.matrix(df_corr_all), type = c(&quot;pearson&quot;))</code></pre>
<p>Create a helper function to generate and plot correlation coefficients.</p>
<pre class="r"><code>sex_diff_corr_summ &lt;- function(x_var, y_var, print_table = TRUE, 
                               corr_all_df = corr_all,
                               corr_M_df = corr_M,
                               corr_F_df = corr_F,
                               show_combined = FALSE) {
  require(tidyverse) # for %&gt;%
  
  corr_all_df &lt;- tibble::tibble(
    cor_coef = corr_all_df$r[x_var, y_var],
    p_val = corr_all_df$P[x_var, y_var],
    n =  corr_all_df$n[x_var, y_var],
    pop = &quot;Both&quot;
  )
  males_df &lt;- tibble::tibble(
    cor_coef = corr_M_df$r[x_var, y_var],
    p_val = corr_M_df$P[x_var, y_var],
    n =  corr_M_df$n[x_var, y_var],
    pop = &quot;Males&quot;
  )
  
  females_df &lt;- tibble::tibble(
    cor_coef = corr_F_df$r[x_var, y_var],
    p_val = corr_F_df$P[x_var, y_var],
    n =  corr_F_df$n[x_var, y_var],
    pop = &quot;Females&quot;
  )
  
  if (show_combined) {
    df &lt;- rbind(corr_all_df, males_df, females_df)
  } else {
    df &lt;- rbind(males_df, females_df)
  }
  
  # Add stars for significance levels
  df &lt;- df %&gt;%
    mutate(., stars = if_else(p_val &lt; .005, &quot;***&quot;,
                              if_else(
                                p_val &lt; .01, &quot;**&quot;,
                                if_else(p_val &lt; .05, &quot;*&quot;, &quot; ns&quot;)
                              )))
  
  if (print_table) {
    kableExtra::kable(df, format = &#39;html&#39;) %&gt;%
      kableExtra::kable_styling()
  } else {
    df
  }
}</code></pre>
<div id="contrast-sensitivity-mental-rotation" class="section level3">
<h3>Contrast sensitivity &amp; mental rotation</h3>
<pre class="r"><code>corr_df &lt;- sex_diff_corr_summ(&quot;log_contrast&quot;, &quot;mental_rot&quot;,
                              corr_all,
                              corr_M_df = corr_M,
                              corr_F_df = corr_F,
                              print_table = FALSE)

sex_diff_scatter(
  sex_diff_df,
  &quot;log_contrast&quot;,
  &quot;mental_rot&quot;,
  x_rev = FALSE,
  y_rev = FALSE,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
    corr_df$stars[3]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  c(-1.5),
  c(33, 35),
  &quot;log(contrast threshold)&quot;,
  &quot;Mental rotation score&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 3 rows containing missing values (geom_point).</code></pre>
<p><img src="img/contrast-sens-mental-rot-1.png" width="2100" style="display: block; margin: auto;" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;log_contrast&quot;, &quot;mental_rot&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.2444586
</td>
<td style="text-align:right;">
0.1929443
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.2838364
</td>
<td style="text-align:right;">
0.0044124
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
</div>
<div id="motion-sensitivity-mental-rotation" class="section level3">
<h3>Motion sensitivity &amp; mental rotation</h3>
<pre class="r"><code>sex_diff_scatter_2 &lt;-
  function(df,
           x_var,
           y_var,
           x_rev = FALSE,
           y_rev = FALSE,
           an_f = &quot;&quot;,
           an_m = &quot;&quot;,
           anx = NULL,
           any = NULL,
           x_lab = &quot;X axis&quot;,
           y_lab = &quot;Y axis&quot;,
           square_axis = TRUE,
           margin_type = &quot;boxplot&quot;,
           show_corr_vals = FALSE) {
    require(tidyverse)
    require(ggExtra)
    
    x_var_s &lt;- sym(x_var)
    y_var_s &lt;- sym(y_var)
    
    p &lt;- ggplot(df) +
      aes(
        x = !!x_var_s,
        y = !!y_var_s,
        group = Sex,
        color = Sex
      ) +
      geom_point() +
      xlab(x_var) +
      ylab(y_var) +
      stat_smooth(method = &quot;lm&quot;, na.rm = TRUE) +
      theme_classic2() +
      theme(legend.position = &quot;bottom&quot;,
            legend.title = element_blank()) +
      xlab(x_lab) +
      ylab(y_lab)

    # if (show_corr_vals) {
    #   p + annotate(
    #     &quot;text&quot;,
    #     x = anx,
    #     y = any,
    #     label = c(an_f, an_m),
    #     color = c(&#39;red&#39;, &#39;darkturquoise&#39;)
    #   )
    # }
    # 
    # if (square_axis)
    # {
    #   p + coord_fixed() + theme(asp.ratio = 1)
    # }
    # 
    # if (stringr::str_detect(x_var, &#39;hobbies&#39;)) {
    #   p &lt;- p + xlim(1, 5)
    # }
    # if (stringr::str_detect(y_var, &#39;hobbies&#39;)) {
    #   p &lt;- p + ylim(1, 5)
    # }
    # 
    # # Reverse scale for threshold measures?
    # if (x_rev)
    #   p &lt;- p + scale_x_reverse()
    # if (y_rev)
    #   p &lt;- p + scale_y_reverse()
    # 
    # p1 &lt;- ggExtra::ggMarginal(p,
    #                           type = margin_type,
    #                           margins = &quot;both&quot;,
    #                           groupFill = TRUE)
    p
  }</code></pre>
<pre class="r"><code>corr_df &lt;- sex_diff_corr_summ(&quot;log_motion&quot;,
                              &quot;mental_rot&quot;, print_table = FALSE)

p_motion &lt;- sex_diff_scatter_2(
  sex_diff_df,
  &quot;log_motion&quot;,
  &quot;mental_rot&quot;,
  x_rev = FALSE,
  y_rev = FALSE,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
    corr_df$stars[3]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  c(-1.8,-1.9),
  c(30, 36),
  &quot;log(motion threshold)&quot;,
  &quot;Mental rotation score&quot;
)

# p_motion &lt;- sex_diff_scatter(
#   sex_diff_df,
#   &quot;log_motion&quot;,
#   &quot;mental_rot&quot;,
#   x_rev = FALSE,
#   y_rev = FALSE,
#   paste0(
#     &quot;r = &quot;,
#     format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
#     corr_df$stars[3]
#   ),
#   paste0(
#     &quot;r = &quot;,
#     format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
#     corr_df$stars[2]
#   ),
#   c(-1.8,-1.9),
#   c(30, 36),
#   &quot;log(motion threshold)&quot;,
#   &quot;Mental rotation score&quot;
# )

p_aug &lt;- p_motion +
  ggplot2::annotate(
    geom = &quot;point&quot;,
    x = sex_diff_df$log_motion[c(115, 118)],
    y = sex_diff_df$mental_rot[c(115, 118)],
    color = &quot;black&quot;,
    size = 4,
    shape = 0
  )

p_aug &lt;- ggExtra::ggMarginal(p_aug,
                             type = &quot;boxplot&quot;,
                             margins = &quot;both&quot;,
                             groupFill = TRUE)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 5 rows containing missing values (geom_point).</code></pre>
<pre class="r"><code>p_aug</code></pre>
<p><img src="img/motion-duration-mental-rot-annotate-outliers-1.png" width="2100" style="display: block; margin: auto;" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;log_motion&quot;, &quot;mental_rot&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.1203345
</td>
<td style="text-align:right;">
0.5264717
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.3166253
</td>
<td style="text-align:right;">
0.0015794
</td>
<td style="text-align:right;">
97
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
</div>
<div id="contrast-sensitivity-male-typed-interests" class="section level3">
<h3>Contrast sensitivity &amp; male-typed interests</h3>
<pre class="r"><code>corr_df &lt;- sex_diff_corr_summ(&quot;log_contrast&quot;, &quot;Masculine_hobbies&quot;,
                              corr_all,
                              corr_M_df = corr_M,
                              corr_F_df = corr_F,
                              print_table = FALSE)

sex_diff_scatter(
  sex_diff_df,
  &quot;log_contrast&quot;,
  &quot;Masculine_hobbies&quot;,
  x_rev = FALSE,
  y_rev = FALSE,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
    corr_df$stars[3]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  c(-1.5),
  c(33, 35),
  &quot;log(contrast threshold)&quot;,
  &quot;Interest in male-typed activities&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 3 rows containing missing values (geom_point).</code></pre>
<p><img src="img/contrast-sens-male-hobbies-1.png" width="2100" style="display: block; margin: auto;" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;log_contrast&quot;, &quot;Masculine_hobbies&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.1494835
</td>
<td style="text-align:right;">
0.4304572
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.1981507
</td>
<td style="text-align:right;">
0.0492898
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
</tbody>
</table></li>
</ul>
</div>
<div id="motion-sensitivity-contrast-sensitivity" class="section level3">
<h3>Motion sensitivity &amp; contrast sensitivity</h3>
<pre class="r"><code>corr_df &lt;- sex_diff_corr_summ(&quot;log_motion&quot;,
                              &quot;log_contrast&quot;, print_table = FALSE)

sex_diff_scatter(
  sex_diff_df,
  &quot;log_motion&quot;,
  &quot;log_contrast&quot;,
  x_rev = FALSE,
  y_rev = FALSE,
  # &quot;r=0.22*&quot;,
  # &quot;r=0.54***&quot;,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
    corr_df$stars[3]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  c(-1.9, -2.04),
  c(-1.4, -1.98),
  &quot;log(motion threshold)&quot;,
  &quot;log(contrast threshold)&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 6 rows containing missing values (geom_point).</code></pre>
<p><img src="img/motion-duration-contrast-sens-1.png" width="2100" style="display: block; margin: auto;" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;log_motion&quot;,
                   &quot;log_contrast&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.4069684
</td>
<td style="text-align:right;">
0.0256180
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:right;">
0.1455917
</td>
<td style="text-align:right;">
0.1569604
</td>
<td style="text-align:right;">
96
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
ns
</td>
</tr>
</tbody>
</table></li>
</ul>
</div>
</div>
</div>
<div id="non-pregistered-analyses" class="section level1">
<h1>Non-pregistered analyses</h1>
<div id="does-vision-account-for-mental-rotation" class="section level2">
<h2>Does vision account for mental rotation?</h2>
<p>There are two approaches to answering this question. One looks for sex differences in the residuals of the models <code>mental rotation ~ contrast</code> and <code>mental rotation ~ motion</code>. The other models <code>mental rotation ~ contrast + sex + contrast:sex</code> and determines whether adding the <code>sex</code> term provides a better fit relative to <code>mental rotation ~ contrast</code> alone.</p>
<div id="residuals-based-approach" class="section level3">
<h3>Residuals-based approach</h3>
<p>We’ll take evaluate the first approach using residuals.</p>
<div id="contrast" class="section level4">
<h4>Contrast</h4>
<p>Focus on the log contrast sensitivity threshold data.</p>
<pre class="r"><code># Select relevant data from data frame.
df_mr_log_contr &lt;- sex_diff_df %&gt;%
  dplyr::select(., Sex, log_contrast, mental_rot) %&gt;%
  dplyr::filter(., !is.na(Sex),
                !is.na(log_contrast),
                !is.na(mental_rot))</code></pre>
<p>Visualize mental rotation scores.</p>
<pre class="r"><code>df_mr_log_contr %&gt;%
  ggplot(.) +
  aes(Sex, mental_rot, color = Sex, alpha = 0.3) +
  geom_boxplot() +
  geom_violin() +
  geom_point() +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="img/unnamed-chunk-54-1.png" width="2100" style="display: block; margin: auto;" /></p>
<pre class="r"><code>t.test(
  mental_rot ~ Sex,
  data = sex_diff_df,
  var.equal = TRUE,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  mental_rot by Sex
## t = -2.7478, df = 129, p-value = 0.003429
## alternative hypothesis: true difference in means between group Females and group Males is less than 0
## 95 percent confidence interval:
##       -Inf -1.373374
## sample estimates:
## mean in group Females   mean in group Males 
##              26.20792              29.66667</code></pre>
<p>Mental rotation scores differ between men and women.</p>
<p>Fit <code>mental_rot ~ log_contrast</code>.</p>
<pre class="r"><code>lm_mr_log_contr &lt;- lm(mental_rot ~ log_contrast, df_mr_log_contr)
summary(lm_mr_log_contr)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast, data = df_mr_log_contr)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.607  -4.304  -0.375   3.773  12.868 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     7.021      5.459   1.286 0.200702    
## log_contrast  -11.334      3.081  -3.678 0.000346 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.943 on 127 degrees of freedom
## Multiple R-squared:  0.09627,    Adjusted R-squared:  0.08916 
## F-statistic: 13.53 on 1 and 127 DF,  p-value: 0.0003455</code></pre>
<p>Extract the residuals and fit <code>mr_resids ~ Sex</code>.</p>
<pre class="r"><code>resids &lt;- resid(lm_mr_log_contr)
df_mr_resids &lt;- data.frame(mr_resids = resids, Sex = df_mr_log_contr$Sex)
lm_mr_resids_sex &lt;- lm(mr_resids ~ Sex, df_mr_resids)
summary(lm_mr_resids_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mr_resids ~ Sex, data = df_mr_resids)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -12.8316  -4.1241  -0.3109   4.2295  13.4513 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  -0.5828     0.5876  -0.992   0.3232  
## SexMales      2.5059     1.2184   2.057   0.0418 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.846 on 127 degrees of freedom
## Multiple R-squared:  0.03223,    Adjusted R-squared:  0.02461 
## F-statistic:  4.23 on 1 and 127 DF,  p-value: 0.04176</code></pre>
<p>Plot to visualize.</p>
<pre class="r"><code>df_mr_resids %&gt;%
  ggplot(.) +
  aes(Sex, mr_resids, color = Sex, alpha = 0.3) +
  geom_boxplot() +
  geom_violin() +
  geom_point() +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="img/unnamed-chunk-58-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>Test for differences in means.</p>
<pre class="r"><code>t.test(
  mr_resids ~ Sex,
  data = df_mr_resids,
  var.equal = TRUE,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  mr_resids by Sex
## t = -2.0567, df = 127, p-value = 0.02088
## alternative hypothesis: true difference in means between group Females and group Males is less than 0
## 95 percent confidence interval:
##        -Inf -0.4871209
## sample estimates:
## mean in group Females   mean in group Males 
##            -0.5827762             1.9231615</code></pre>
<p>So, including contrast sensitivity reduces, but does not eliminate, a statistically significant difference in mental rotation scores by sex favoring men.</p>
</div>
<div id="motion" class="section level4">
<h4>Motion</h4>
<pre class="r"><code># Select relevant data from data frame.
df_mr_log_motion &lt;- sex_diff_df %&gt;%
  dplyr::select(., Sex, log_motion, mental_rot) %&gt;%
  dplyr::filter(., !is.na(Sex),
                !is.na(log_motion),
                !is.na(mental_rot))</code></pre>
<p>Fit <code>mental_rot ~ log_cmotion</code>.</p>
<pre class="r"><code>lm_mr_log_motion &lt;- lm(mental_rot ~ log_motion, df_mr_log_motion)
summary(lm_mr_log_motion)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_motion, data = df_mr_log_motion)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -13.025  -3.912  -0.741   3.405  15.268 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   13.087      4.663   2.806  0.00581 **
## log_motion    -6.075      2.002  -3.035  0.00293 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.925 on 125 degrees of freedom
## Multiple R-squared:  0.06862,    Adjusted R-squared:  0.06117 
## F-statistic:  9.21 on 1 and 125 DF,  p-value: 0.002929</code></pre>
<p>Extract the residuals and fit <code>mr_resids ~ Sex</code>.</p>
<pre class="r"><code>resids &lt;- resid(lm_mr_log_motion)
df_mr_resids &lt;- data.frame(mr_resids = resids, Sex = df_mr_log_motion$Sex)
lm_mr_resids_sex &lt;- lm(mr_resids ~ Sex, df_mr_resids)
summary(lm_mr_resids_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mr_resids ~ Sex, data = df_mr_resids)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -12.5096  -4.0476  -0.6484   3.8227  13.6024 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  -0.5151     0.5941  -0.867   0.3876  
## SexMales      2.1804     1.2224   1.784   0.0769 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.851 on 125 degrees of freedom
## Multiple R-squared:  0.02482,    Adjusted R-squared:  0.01702 
## F-statistic: 3.182 on 1 and 125 DF,  p-value: 0.0769</code></pre>
<p>Plot to visualize.</p>
<pre class="r"><code>df_mr_resids %&gt;%
  ggplot(.) +
  aes(Sex, mr_resids, color = Sex, alpha = 0.3) +
  geom_boxplot() +
  geom_violin() +
  geom_point() +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="img/unnamed-chunk-63-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>Test for mean differences.</p>
<pre class="r"><code>t.test(
  mr_resids ~ Sex,
  data = df_mr_resids,
  var.equal = TRUE,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  mr_resids by Sex
## t = -1.7837, df = 125, p-value = 0.03845
## alternative hypothesis: true difference in means between group Females and group Males is less than 0
## 95 percent confidence interval:
##        -Inf -0.1547076
## sample estimates:
## mean in group Females   mean in group Males 
##            -0.5150549             1.6653441</code></pre>
<p>So, including motion reduces but does not eliminate a statistically significant difference in mental rotation scores by sex favoring men.</p>
</div>
</div>
<div id="model-based-approach" class="section level3">
<h3>Model-based approach</h3>
<p>Let’s see whether combining the vision measures can do even better in accounting for mental rotation.</p>
<pre class="r"><code>df_mr_contr_motion &lt;- sex_diff_df %&gt;%
  dplyr::select(., Sex, log_contrast, log_motion, mental_rot) %&gt;%
  dplyr::filter(., !is.na(Sex),
                !is.na(log_contrast),
                !is.na(log_motion),
                !is.na(mental_rot))</code></pre>
<p>Full model.</p>
<pre class="r"><code>lm_mr_contr_motion_full &lt;- lm(mental_rot ~ log_contrast*log_motion*Sex, data = df_mr_contr_motion)
summary(lm_mr_contr_motion_full)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast * log_motion * Sex, data = df_mr_contr_motion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -14.3999  -3.7147  -0.1083   3.3877  12.0877 
## 
## Coefficients:
##                                  Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                        -24.30      59.33  -0.409    0.683
## log_contrast                       -20.43      34.16  -0.598    0.551
## log_motion                         -17.08      26.40  -0.647    0.519
## SexMales                           -56.73      98.86  -0.574    0.567
## log_contrast:log_motion             -5.99      15.16  -0.395    0.693
## log_contrast:SexMales              -52.77      57.80  -0.913    0.363
## log_motion:SexMales                -22.18      45.59  -0.486    0.628
## log_contrast:log_motion:SexMales   -20.56      26.30  -0.782    0.436
## 
## Residual standard error: 5.682 on 117 degrees of freedom
## Multiple R-squared:  0.1913, Adjusted R-squared:  0.143 
## F-statistic: 3.955 on 7 and 117 DF,  p-value: 0.0006531</code></pre>
<p>Drop interactions.</p>
<pre class="r"><code>lm_mr_contr_motion_no_interactions &lt;- lm(mental_rot ~ log_contrast + log_motion + Sex, data = df_mr_contr_motion)
summary(lm_mr_contr_motion_no_interactions)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast + log_motion + Sex, data = df_mr_contr_motion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -12.6528  -4.0435  -0.1531   3.8296  12.6256 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)     4.024      6.698   0.601   0.5491  
## log_contrast   -7.716      3.264  -2.364   0.0197 *
## log_motion     -3.911      2.087  -1.874   0.0634 .
## SexMales        1.936      1.284   1.507   0.1343  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.784 on 121 degrees of freedom
## Multiple R-squared:  0.1335, Adjusted R-squared:  0.112 
## F-statistic: 6.212 on 3 and 121 DF,  p-value: 0.0005839</code></pre>
<p>Drop sex.</p>
<pre class="r"><code>lm_mr_contr_motion_no_sex &lt;- lm(mental_rot ~ log_contrast + log_motion, data = df_mr_contr_motion)
summary(lm_mr_contr_motion_no_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast + log_motion, data = df_mr_contr_motion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -13.2734  -4.0444  -0.2688   3.3211  14.5612 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)     1.268      6.477   0.196   0.8451  
## log_contrast   -8.470      3.243  -2.612   0.0101 *
## log_motion     -4.727      2.026  -2.333   0.0213 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.814 on 122 degrees of freedom
## Multiple R-squared:  0.1172, Adjusted R-squared:  0.1027 
## F-statistic: 8.097 on 2 and 122 DF,  p-value: 0.000499</code></pre>
<p>Compare models.</p>
<pre class="r"><code>anova(lm_mr_contr_motion_no_sex, lm_mr_contr_motion_no_interactions)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: mental_rot ~ log_contrast + log_motion
## Model 2: mental_rot ~ log_contrast + log_motion + Sex
##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
## 1    122 4123.5                           
## 2    121 4047.5  1    76.009 2.2723 0.1343</code></pre>
<p>So, the RSS drops a bit, but not significantly. All things being equal, we’d choose the simpler model for parsimony reasons.</p>
<p>Here’s a model with sex alone.</p>
<pre class="r"><code>lm_mr_only_sex &lt;- lm(mental_rot ~ Sex, data = df_mr_contr_motion)
summary(lm_mr_only_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ Sex, data = df_mr_contr_motion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -11.6667  -3.6667  -0.3684   3.6316  13.6316 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  26.3684     0.6152  42.860  &lt; 2e-16 ***
## SexMales      3.2982     1.2558   2.626  0.00973 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.996 on 123 degrees of freedom
## Multiple R-squared:  0.0531, Adjusted R-squared:  0.0454 
## F-statistic: 6.898 on 1 and 123 DF,  p-value: 0.009727</code></pre>
<p>Comparing this to one with vision but not sex.</p>
<pre class="r"><code>anova(lm_mr_only_sex, lm_mr_contr_motion_no_sex)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: mental_rot ~ Sex
## Model 2: mental_rot ~ log_contrast + log_motion
##   Res.Df    RSS Df Sum of Sq      F   Pr(&gt;F)   
## 1    123 4422.8                                
## 2    122 4123.5  1    299.31 8.8557 0.003524 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The model with the smaller RSS is the one with the vision variables included.</p>
<p>We conclude that vision measures are a better predictor of individual differences in mental rotation scores than sex.</p>
</div>
</div>
<div id="do-outliers-account-for-results" class="section level2">
<h2>Do outliers account for results?</h2>
<p>The scatterplots indicate that despite the log transformation, there are some individual participants who had especially high thresholds for contrast and motion duration.</p>
<p>Do our results hold when we trim the data to focus on those individuals whose data are within 3 standard deviations of the mean log threshold?</p>
<p>We define a helper function to detect outliers.</p>
<pre class="r"><code>FindOutliers &lt;- function(data, sd_thresh = as.numeric(params$outlier_sd_thresh)) {
  sd = sd(data, na.rm = T)
  mean = mean(data, na.rm = T)
  # we identify extreme outliers
  extreme.threshold.upper = (sd * sd_thresh) + mean
  extreme.threshold.lower = -(sd * sd_thresh) + mean
  result &lt;-
    which(data &gt; extreme.threshold.upper |
            data &lt; extreme.threshold.lower)
  print(result)
}

#all_outliers &lt;- lapply(sex_diff_df, FindOutliers)</code></pre>
<div id="visual-perception-thresholds-1" class="section level3">
<h3>Visual perception thresholds</h3>
<div id="contrast-thresholds-1" class="section level4">
<h4>Contrast thresholds</h4>
<p>We detect outliers in contrast threshold.</p>
<pre class="r"><code>FindOutliers(sex_diff_df$log_contrast)</code></pre>
<pre><code>## integer(0)</code></pre>
<p>No contrast thresholds exceed the criterion.</p>
</div>
<div id="motion-duration-thresholds-1" class="section level4">
<h4>Motion duration thresholds</h4>
<pre class="r"><code>FindOutliers(sex_diff_df$log_motion)</code></pre>
<pre><code>## [1] 115 118</code></pre>
<p>Two cases exceed the criterion for motion.</p>
<p>Create a new trimmed data frame.</p>
<pre class="r"><code>df_trimmed &lt;- sex_diff_df[-c(FindOutliers(sex_diff_df$log_motion)),]</code></pre>
<pre><code>## [1] 115 118</code></pre>
<pre class="r"><code>xtabs(~ Sex, df_trimmed)</code></pre>
<pre><code>## Sex
## Females   Males 
##     100      30</code></pre>
<pre class="r"><code>df_trimmed %&gt;%
  ggplot() +
  aes(Sex, log_motion) +
  geom_boxplot()</code></pre>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="img/unnamed-chunk-77-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>We then test for a difference in means.</p>
<pre class="r"><code>mdt_tt &lt;-
  t.test(
    log_motion ~ Sex,
    data = df_trimmed,
    var.equal = TRUE,
    alternative = &quot;greater&quot;
  ) # Hypothesized
mdt_tt</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  log_motion by Sex
## t = 3.7359, df = 124, p-value = 0.000142
## alternative hypothesis: true difference in means between group Females and group Males is greater than 0
## 95 percent confidence interval:
##  0.089656      Inf
## sample estimates:
## mean in group Females   mean in group Males 
##             -2.293820             -2.454955</code></pre>
<p>Women still have larger motion duration threshold than men.</p>
</div>
</div>
<div id="mental-rotation" class="section level3">
<h3>Mental rotation</h3>
<pre class="r"><code>FindOutliers(sex_diff_df$mental_rot)</code></pre>
<pre><code>## integer(0)</code></pre>
<p>There were no outliers in mental rotation.</p>
</div>
<div id="vocabulary" class="section level3">
<h3>Vocabulary</h3>
<pre class="r"><code>FindOutliers(sex_diff_df$vocab)</code></pre>
<pre><code>## integer(0)</code></pre>
<p>There were no outliers in vocabulary.</p>
</div>
</div>
<div id="correlations-among-measures-1" class="section level2">
<h2>Correlations among measures</h2>
<p>Since trimming outliers only affected the motion threshold data, we focus on that measure.</p>
<pre class="r"><code>sex_diff_df_F &lt;- df_trimmed %&gt;%
  dplyr::filter(., Sex == &quot;Females&quot;)

sex_diff_df_M &lt;- df_trimmed %&gt;%
  dplyr::filter(., Sex == &quot;Males&quot;)</code></pre>
<div id="motion-thresholds-and-mental-rotation-1" class="section level3">
<h3>Motion thresholds and mental rotation</h3>
<pre class="r"><code>cor.test(
  sex_diff_df_F$log_motion,
  sex_diff_df_F$mental_rot,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_F$log_motion and sex_diff_df_F$mental_rot
## t = -3.0141, df = 93, p-value = 0.001661
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.0000000 -0.1353437
## sample estimates:
##        cor 
## -0.2983134</code></pre>
<p>Log(motion duration) thresholds (negatively) correlate with mental rotation scores in women, even after trimming.</p>
<pre class="r"><code>cor.test(
  sex_diff_df_M$log_motion,
  sex_diff_df_M$mental_rot,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_M$log_motion and sex_diff_df_M$mental_rot
## t = 0.64141, df = 28, p-value = 0.7368
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.0000000  0.4115473
## sample estimates:
##       cor 
## 0.1203345</code></pre>
<p>Motion duration thresholds do not correlate with mental rotation scores in men.</p>
</div>
<div id="contrast-thresholds-and-motion-thresholds-1" class="section level3">
<h3>Contrast thresholds and motion thresholds</h3>
<div id="women-6" class="section level4">
<h4>Women</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_F$log_contrast,
  sex_diff_df_F$log_motion,
  method = &quot;pearson&quot;,
  alternative = &quot;greater&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_F$log_contrast and sex_diff_df_F$log_motion
## t = 2.0919, df = 92, p-value = 0.0196
## alternative hypothesis: true correlation is greater than 0
## 95 percent confidence interval:
##  0.0439443 1.0000000
## sample estimates:
##       cor 
## 0.2130843</code></pre>
<p>The vision measures now correlate in women</p>
<pre class="r"><code>es_contrast_motion &lt;- esci::estimateCorrelation.default(sex_diff_df_F, log_contrast, log_motion)</code></pre>
<pre><code>## Warning in predict.lm(lbf, interval = &quot;prediction&quot;, level = conf.level): predictions on current data refer to _future_ responses</code></pre>
<pre class="r"><code>#es_contrast_motion</code></pre>
<p>We find that a correlation between log contrast and log motion thresholds in women is as follows: r = 0.21 95% CI [0.01, 0.40].</p>
</div>
<div id="men-6" class="section level4">
<h4>Men</h4>
<pre class="r"><code>cor.test(
  sex_diff_df_M$log_contrast,
  sex_diff_df_M$log_motion,
  method = &quot;pearson&quot;,
  alternative = &quot;greater&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sex_diff_df_M$log_contrast and sex_diff_df_M$log_motion
## t = 2.3575, df = 28, p-value = 0.01281
## alternative hypothesis: true correlation is greater than 0
## 95 percent confidence interval:
##  0.1149104 1.0000000
## sample estimates:
##       cor 
## 0.4069684</code></pre>
<p>The vision measures still correlate in men.</p>
</div>
</div>
<div id="model-based-approach-1" class="section level3">
<h3>Model-based approach</h3>
<p>Do the trimmed data show a stronger relationship between vision and mental rotation than sex and mental rotation?</p>
<pre class="r"><code>df_mr_contr_motion &lt;- df_trimmed %&gt;%
  dplyr::select(., Sex, log_contrast, log_motion, mental_rot) %&gt;%
  dplyr::filter(., !is.na(Sex),
                !is.na(log_contrast),
                !is.na(log_motion),
                !is.na(mental_rot))</code></pre>
<p>Vision plus sex.</p>
<pre class="r"><code>lm_mr_contr_motion_no_interactions &lt;- lm(mental_rot ~ log_contrast + log_motion + Sex, data = df_mr_contr_motion)
summary(lm_mr_contr_motion_no_interactions)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast + log_motion + Sex, data = df_mr_contr_motion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -12.5919  -3.8332  -0.3085   3.7997  12.6954 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)     5.378      7.273   0.739   0.4611  
## log_contrast   -7.946      3.327  -2.388   0.0185 *
## log_motion     -3.166      2.621  -1.208   0.2296  
## SexMales        1.991      1.299   1.532   0.1281  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.818 on 119 degrees of freedom
## Multiple R-squared:  0.1176, Adjusted R-squared:  0.09533 
## F-statistic: 5.285 on 3 and 119 DF,  p-value: 0.001863</code></pre>
<p>Vision alone.</p>
<pre class="r"><code>lm_mr_contr_motion_no_sex &lt;- lm(mental_rot ~ log_contrast + log_motion, data = df_mr_contr_motion)
summary(lm_mr_contr_motion_no_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast + log_motion, data = df_mr_contr_motion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -13.2482  -4.0821  -0.3296   3.3382  14.2608 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)     2.128      6.996   0.304   0.7615  
## log_contrast   -8.624      3.316  -2.601   0.0105 *
## log_motion     -4.253      2.537  -1.676   0.0963 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.85 on 120 degrees of freedom
## Multiple R-squared:  0.1002, Adjusted R-squared:  0.08517 
## F-statistic: 6.679 on 2 and 120 DF,  p-value: 0.001777</code></pre>
<p>Compare models.</p>
<pre class="r"><code>anova(lm_mr_contr_motion_no_sex, lm_mr_contr_motion_no_interactions)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: mental_rot ~ log_contrast + log_motion
## Model 2: mental_rot ~ log_contrast + log_motion + Sex
##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
## 1    120 4107.4                           
## 2    119 4027.9  1    79.464 2.3477 0.1281</code></pre>
<p>So, the RSS drops a bit, but not significantly. All things being equal, we’d choose the simpler model for parsimony reasons.</p>
<p>Here’s a model with sex alone.</p>
<pre class="r"><code>lm_mr_only_sex &lt;- lm(mental_rot ~ Sex, data = df_mr_contr_motion)
summary(lm_mr_only_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ Sex, data = df_mr_contr_motion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -11.6667  -3.6667   0.3333   3.4946  13.4946 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  26.5054     0.6209  42.690   &lt;2e-16 ***
## SexMales      3.1613     1.2572   2.515   0.0132 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.988 on 121 degrees of freedom
## Multiple R-squared:  0.04966,    Adjusted R-squared:  0.04181 
## F-statistic: 6.323 on 1 and 121 DF,  p-value: 0.01323</code></pre>
<p>Comparing this to one with vision but not sex.</p>
<pre class="r"><code>anova(lm_mr_only_sex, lm_mr_contr_motion_no_sex)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: mental_rot ~ Sex
## Model 2: mental_rot ~ log_contrast + log_motion
##   Res.Df    RSS Df Sum of Sq      F  Pr(&gt;F)  
## 1    121 4337.9                              
## 2    120 4107.4  1    230.55 6.7356 0.01063 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The model with the smaller RSS is the one with the vision variables included.</p>
<p>We still conclude that vision measures are a better predictor of individual differences in mental rotation scores than sex.</p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
